function callEvent(a,b){var c;"function"===typeof Event?c=new Event(b):(c=document.createEvent("Event"),c.initEvent(b,!0,!0));a.dispatchEvent(c)}function msiebox(a){"MSIE9"==currentBrowser()&&(a.onresize=function(a){do a=this.firstChild;while(1!=a.nodeType);this.offsetHeight!=a.offsetHeight&&(a.style.height=this.offsetHeight+"px")})}
function getStyle(a,b,c){if(window.getComputedStyle)return(c||document).defaultView.getComputedStyle(a,null).getPropertyValue(b)||"";if(a.currentStyle)return a.currentStyle[b]||""}function emulateEventHandlers(a){for(var b=0;b<a.length;b++)document.addEventListener(a[b],function(a){window.event=a},!0)}"object"==typeof window.event?"":emulateEventHandlers(["mousemove","mousedown","mouseover"]);
window.opera&&11>parseInt(window.opera.version(),10)&&"undefined"==typeof document.getElementsByTagName("html")[0].oncontextmenu&&(window.addEventListener("mousedown",function(a){if(a.altKey)return a.preventDefault(),a.cancelBubble=!0,!1;if(2==a.button){var b=a.srcElement;do{if(b.oncontextmenu){a.preventDefault();a.cancelBubble=!0;window.opera.__overrideBtn&&(window.opera.__overrideBtn.parentNode.removeChild(window.opera.__overrideBtn),window.opera.__overrideBtn=null);window.opera.__overrideBtn=document.createElement("input");
window.opera.__overrideBtn.type="button";window.opera.__overrideBtn.style.position="absolute";window.opera.__overrideBtn.style.zIndex=1E4;window.opera.__overrideBtn.style.width="5px;";window.opera.__overrideBtn.style.height="5px;";window.opera.__overrideBtn.style.left=a.clientX-2+"px";window.opera.__overrideBtn.style.top=a.clientY-2+"px";window.opera.__overrideBtn.style.opacity=.01;document.body.appendChild(window.opera.__overrideBtn);b.oncontextmenu({type:"contextmenu",srcElement:a.srcElement,clientX:a.clientX,
clientY:a.clientY,button:2});break}b=b.parentNode}while(b!=document)}},!0),window.addEventListener("mouseup",function(a){window.opera.__overrideBtn&&(window.opera.__overrideBtn.parentNode.removeChild(window.opera.__overrideBtn),window.opera.__overrideBtn=null)},!0),window.addEventListener("click",function(a){if(a.altKey){var b=a.srcElement;do{if(b.oncontextmenu){a.preventDefault();a.cancelBubble=!0;b.oncontextmenu({type:"contextmenu",srcElement:a.srcElement,clientX:a.clientX,clientY:a.clientY,button:2});
break}b=b.parentNode}while(b!=document);return!1}},!0));
function AttachEvent(a,b,c){a.addEventListener?(b=b.substr(2),"mousewheel"==b?(Is.Defined(document.documentElement.onwheel)||8<(document.documentMode||0)?b="wheel":"Mozilla"==currentBrowser()&&(b="DOMMouseScroll"),a.addEventListener(b,function(a){a=a||window.event;var b={originalEvent:a,type:a.type,srcElement:a.target||a.srcElement,deltaX:0,deltaY:0};"mousewheel"==a.type?(Is.Defined(a.wheelDeltaX)&&(b.deltaX=a.wheelDeltaX/-40),Is.Defined(a.wheelDeltaY)?b.deltaY=a.wheelDeltaY/-40:b.deltaY=a.wheelDelta/
-40):"wheel"==a.type?document.documentMode&&8<document.documentMode||-1!=navigator.userAgent.indexOf("WebKit")?(b.deltaX=a.deltaX/40,b.deltaY=a.deltaY/40):(b.deltaX=a.deltaX,b.deltaY=a.deltaY):Is.Defined(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b.deltaX=a.detail:b.deltaY=a.detail;c(b)},!1)):a.addEventListener(b,c,!1)):a.attachEvent&&a.attachEvent(b,function(){if("onmousewheel"==b){var d=arguments[0]||window.event;c.apply(a,[{originalEvent:d,type:d.type,srcElement:d.target||d.srcElement,deltaX:0,deltaY:d.wheelDelta/
-40}])}else c.apply(a,arguments)})}function unique_id(){return 1E18*Math.random()+""+(new Date).getTime()}
function downloadItem(a,b){if("MSIE7"==currentBrowser()||b&&"https:"==location.protocol){var c=window.open(b?a:"server/download.php?"+a,"file","scrollbars=yes,location=yes,toolbar=yes,status=yes,menubar=yes,resizable=yes,width=200,height=200");if(c&&c.document){c.document.onload=function(){window.close()};return}}var c="ifrm_download_"+unique_id(),d=mkElement("iframe",{id:c,src:b?a:"server/download.php?"+a});d.style.position="absolute";d.style.width="1px";d.style.height="1px";d.style.top="0";d.style.left=
"-1000px";document.getElementsByTagName("body")[0].appendChild(d);setTimeout("try{ var elm; if ((elm = document.getElementById('"+c+"'))) elm.parentNode.removeChild(elm); }catch(r){}",12E4);d=null}function openItem(a,b,c){window.open(b?a:"server/download.php?"+a,c||"file","menubar=no,resizable=yes,status=no,location=no")}
var GSM0338_To_Unicode_Charset=[64,36,165,232,233,249,236,242,231,10,216,248,13,197,229,916,95,934,915,923,937,928,936,931,920,926,27,198,230,223,201,32,33,34,35,164,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,161,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,196,214,209,220,167,191,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,228,246,241,252,224];
Math.ceilFloat=function(a,b){b=this.pow(10,parseInt(b,10))||1;return this.ceil(parseFloat(a)*b)/b};Math.rand=function(a){a=a||1E16;return this.floor(this.random()*a+1)};_me=cMaxZIndex.prototype;function cMaxZIndex(){this.zindex=[500]}_me.get=function(a){var b=this.zindex[this.zindex.length-1]+1;a||this.zindex.push(b);return b};_me.remove=function(a){a=inArray(this.zindex,a);-1<a&&this.zindex.splice(a,1)};maxZIndex=new cMaxZIndex;
function setSelectAll(a){try{a.style.setProperty("MozUserSelect","text",""),a.style.setProperty("-moz-user-select","text","")}catch(b){}try{a.unselectable="off"}catch(b){}try{a.style.KhtmlUserSelect="text"}catch(b){}try{a.style.WebkitUserSelect="text"}catch(b){}}function setSelectNone(a){}
function pubEval(a){if(!a)return!1;navigator.userAgent.toLowerCase();try{if("object"==typeof window.execScript)window.execScript(a);else if("Safari"==currentBrowser()||"KHTML"==currentBrowser()){window.tmp_codeEval=a;var b=document.createElement("script");b.type="text/javascript";b.innerHTML='eval(window.tmp_codeEval); window.tmp_codeEval = "";';document.getElementsByTagName("head")[0].appendChild(b);b.parentNode.removeChild(b)}else window.eval(a)}catch(c){throw Error("pubEval() - unable to Eval: \r\n"+
a);}}function mkElement(a,b,c){a=(c||document).createElement(a);if("object"==typeof b)for(var d in b)try{switch(d){case "style":if(Is.Object(b[d])){for(var e in b[d])a.style[e]=b[d][e];break}case "href":b[d]&&(a[d]=b[d]);break;case "for":a.setAttribute(d,b[d]);break;case "text":a.appendChild((c||document).createTextNode(b[d]));break;default:a[d]=b[d]}}catch(f){}return a}function isDescendent(a,b){for(;b=b.parentNode;)if(b==a)return!0;return!1}
function addcss(a){if(a){for(var b=[],c=1;c<arguments.length;c++)Is.String(arguments[c])&&(b=b.concat(arguments[c].trim().split(" ")));if(a.classList&&a.classList.add)for(c=0;c<b.length;c++)a.classList.add(b[c]);else{var d=a.className?a.className.split(" "):[];if(d.length){for(var e in d)d[e]&&(d[e]=d[e].trim());for(c=0;c<b.length;c++)0>inArray(d,b[c])&&d.push(b[c]);d=d.join(" ");a.className!=d&&(a.className=d)}else a.className=b.join(" ")}}}
function removecss(a){if(a)if(2>arguments.length)a.className="";else if(a.classList&&a.classList.remove)for(var b=1;b<arguments.length;b++)Is.String(arguments[b])&&a.classList.remove(-1<arguments[b].indexOf(" ")?arguments[b].trim():arguments[b]);else{for(var c=a.className?a.className.split(" "):[],d=c.length,b=1;b<arguments.length;b++)if(Is.String(arguments[b]))for(var e=c.length-1;-1<e;e--)c[e].toLowerCase()==arguments[b].toLowerCase()&&c.splice(e,1);c.length!=d&&(a.className=c.join(" "))}}
function hascss(a,b){return-1<inArray((a.className||"").split(" "),b)}
function getSize(a,b){var c={x:0,y:0,h:a.offsetHeight,w:a.offsetWidth};if(a.getBoundingClientRect){b=b||document;var d=a.getBoundingClientRect();c.x=d.left+Math.max(b.documentElement.scrollLeft,b.body.scrollLeft);c.y=d.top+Math.max(b.documentElement.scrollTop,b.body.scrollTop);"MSIE7"==currentBrowser()&&(c.x--,c.y--)}else for(c.x=a.offsetLeft,c.y=a.offsetTop;(a=a.offsetParent)&&a&&"BODY"!=a.tagName;)c.x+=a.offsetLeft-a.scrollLeft,c.y+=a.offsetTop-a.scrollTop;return c}
window.Is={Boolean:function(a){return"boolean"==typeof a},Array:function(a){return Is.Object(a)&&a.constructor==Array},Empty:function(a){if(Is.Object(a))if(Is.Array(a)){if(a.length)return!1}else for(var b in a)if(!Is.Undefined(a[b]))return!1;return!0},Function:function(a){return"function"==typeof a},Null:function(a){return"object"==typeof a&&!a},Number:function(a){return"number"==typeof a&&isFinite(a)},Object:function(a){return a&&"object"==typeof a||Is.Function(a)},String:function(a){return"string"==
typeof a},Email:function(a){return Is.String(a)?RegExp("^([a-z0-9\\'\\!\\#\\$\\%\\&\\+\\-\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\*][\\.]?)+\\@[a-z0-9]+([\\.\\-\\_]?[a-z0-9])*\\.[a-z]{2,6}$","gim").test(a):!1},Domain:function(a){return Is.String(a)?/^([a-z0-9][\\-\\_\\.]?)*\\.[a-z]{2,6}$/gim.test(a):!1},Undefined:function(a){return"undefined"==typeof a},URL:function(a){return Is.String(a)?/^http(s?):\/\/[a-z0-9]*/gim.test(a):!1},Filename:function(a){return Is.String(a)&&a.length?!/[\/\\\|\?\<\>\:\*]/gm.test(a):
!1},Defined:function(a){return!Is.Undefined(a)},Date:function(a,b,c){var d=[31,28,31,30,31,30,31,31,30,31,30,31],e=0;a=parseInt(a,10);b=parseInt(b,10);c=parseInt(c,10);if(!Is.Number(a)||!Is.Number(b)||!Is.Number(c))return!1;d[1]=0==a%4&&0!=a%100||0==a%400?29:28;e=d[b-1];return 0>a||12<b||1>b||c>e||1>c?!1:!0},Child:function(a,b,c){if(Is.String(b)){b=b.toUpperCase();try{do{if(a.tagName==b)return a;if(c&&c==a)break}while(a=a.parentNode)}catch(d){}}else try{do{if(a==b)return a;if(c&&c==a)break}while(a=
a.parentNode)}catch(d){}return!1}};String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};String.prototype.unentityify=function(){return this.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")};String.prototype.urlEncode=function(){return escape(this).replace(/\+/g,"%2B").replace(/%20/g,"+").replace(/\*/g,"%2A").replace(/\//g,"%2F").replace(/@/g,"%40")};
String.prototype.highlight_links=function(a){var b=this;0<this.indexOf("@")&&0>this.indexOf("/")&&(a=a||"",b=b.replace(/(([a-z0-9]{,32}[\-\_\.]?){,5}[a-z0-9]{1,32}\@[a-z0-9]{1,32}([\.\-\_]?[a-z0-9]){,32}\.[a-z]{2,4})/g,'<a href="mailto:$1"'+(a?" "+a:"")+">$1</a>"));return b=b.replace(/([A-Za-z]{3,5}:\/\/[A-Za-z0-9-_\:]+(\.|\/)(&[a-zA-Z]+;|[A-Za-z0-9\-\_%&\@\?\#\:\/\.=\+\!\~])+[^\s\W])/g,'<a href="$1" target="_blank">$1</a>')};
String.prototype.str_replace=function(a,b){for(var c=[].concat(a),d=[].concat(b),e=this,f=0,g=c.length;f<g;f++)e=e.split(c[f]).join(d[f]||"");return e.toString()};String.prototype.escapeXML=function(a){var b=this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a&&(b=b.replace(/'/g,"&apos;").replace(/"/g,"&quot;"));return b};
String.prototype.unescapeXML=function(){return this.replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&quot;/gi,'"').replace(/&apos;/gi,'"').replace(/&amp;/gi,"&")};
String.prototype.escapeHTML=function(){if("MSIE7"==currentBrowser()&&-1!=this.indexOf("\n"))return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");var a=document.createElement("div");a.appendChild(document.createTextNode(this));return"Safari"==currentBrowser()||"KHTML"==currentBrowser()?a.innerHTML.replace(/>/gm,"&gt;"):a.innerHTML};
String.prototype.unescapeHTML=function(){if(0>this.indexOf("&"))return this.toString();var a=document.createElement("div");a.innerHTML=this.toString();for(var a=a.childNodes[0],b=a.nodeValue;;)if(a=a.nextSibling)a.nodeValue&&(b+=a.nodeValue);else break;return b};
String.prototype.quote=function(){var a,b,c=this.length,d='"';for(b=0;b<c;b+=1)if(a=this.charAt(b)," "<=a){if("\\"==a||'"'==a)d+="\\";d+=a}else switch(a){case "\b":d+="\\b";break;case "\f":d+="\\f";break;case "\n":d+="\\n";break;case "\r":d+="\\r";break;case "\t":d+="\\t";break;default:a=a.charCodeAt().toString(16),d=1==a.length?d+("\\u000"+a):d+("\\u00"+a)}return d+'"'};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
"a".split(/a/gi).length?String.prototype.realsplit=String.prototype.split:String.prototype.realsplit=function(a){if(a instanceof RegExp){for(var b=[],c,d=0;c=a.exec(this);)b.push(this.slice(d,c.index)),c[1]&&b.push(c[1]),d=a.lastIndex;b.push(this.slice(d));return b}return String.prototype.split.apply(this,arguments)};String.prototype.remove=function(a,b){var c;c=Is.String(a)?new RegExp(a,"undefined"!=typeof b?b:"g"):a;return this.replace(c,"")};
String.prototype.wrap=function(){return this.replace(/(\r\n)|(\r)|(\n)/gm,"<br />")};String.prototype.removeTags=function(a){return this.replace(/<[\!\/]?([\-a-zA-Z0-9]+)[^>^<]*>/gm,a||"").replace(/\&nbsp\;/g," ")};String.prototype.quoteSQL=function(){return this.replace(/([\'])/g,"$1$1").replace(/([%])/g,"\\$1")};String.prototype.quoteMeta=function(){return this.replace(/([\!\#\$\%\^\@\.\&\*\(\)\-\_\=\+\:\;\"\'\\\/\?\<\>\~\[\]\{\}\`])/g,"\\$1")};
Number.prototype.toCurrency=function(a,b){var c=a?{style:"currency",currency:a}:{};b&&(c.maximumFractionDigits=0);return this.toLocaleString(document.documentElement.lang,c)};Number.prototype.toComputerByteUnits=function(a,b){b=Number.byteunits[(b||"").toLowerCase()]||0;return relativeByteSize(this,a,b)};Number.prototype.toDecimalByteUnits=function(a,b){b=Number.byteunits[(b||"").toLowerCase()]||0;return relativeByteSize(this,a,b,1E3)};Number.byteunits={b:0,kb:1,mb:2,gb:3,tb:4};
var GlobalTools={search:function(a){this.text=a;this.word=""}};GlobalTools.search.prototype.find=function(a){a&&(this.word=a,this.re=new RegExp("("+this.word.quoteMeta()+")","gi"));if(this.text&&this.word)return this.matches=this.text.realsplit(this.re),1<this.matches.length?(this.matches.length-1)/2:!1;this.matches=null;return!1};GlobalTools.search.prototype.within=function(a){this.text=a;return this};
GlobalTools.search.prototype.highlight=function(a){a||(a="strong");var b=this.matches.slice(0),c=this.matches.length;if(c){for(;c--;)b[c]=c&1?"<"+a+">"+b[c].escapeXML()+"</"+a+">":b[c].escapeXML();return b.join("")}return!1};function dec2hex(a){return a.toString(16)}function hex2dec(a){return parseInt(a,16)}
Date.prototype.toWMString=function(a,b,c,d){var e=/^(\d{1})$/g;if(c){var f=new Date;this.getFullYear()==f.getFullYear()?this.getMonth()==f.getMonth()&&this.getDate()==f.getDate()&&(b=!0):c=!1}var g="",h="";if(!b){b=this.getFullYear().toString();var l=(this.getMonth()+1).toString().replace(e,"0$1"),k=this.getDate().toString().replace(e,"0$1");if(c&&!d&&f.getJulianDate()==this.getJulianDate()+1)h=getLang("CALENDAR::YESTERDAY");else switch(storage.library("gw_others"),parseInt(GWOthers.getItem("LAYOUT_SETTINGS",
"date_format"),10)){default:case 0:g=l+"/"+k+(c?"":"/"+b.substr(2));break;case 1:g=l+"/"+k+(c?"":"/"+b);break;case 2:g=k+"-"+l+(c?"":"-"+b);break;case 3:g=k+"/"+l+(c?"":"/"+b);break;case 4:g=(c?"":b+"-")+l+"-"+k;break;case 5:g=k+"-"+l+(c?"":"-"+b.substr(2));break;case 6:g=k+"/"+l+(c?"":"/"+b.substr(2));break;case 7:g=k+"."+l+(c?"":"."+b.substr(2));break;case 8:g=k+"."+l+(c?"":"."+b);break;case 9:g=k+" "+getLang("SHORT_MONTHS::"+"January February March April May June July August September October November December".split(" ")[this.getMonth()])+
(c?"":" "+b.substr(2));break;case 10:g=k+" "+getLang("SHORT_MONTHS::"+"January February March April May June July August September October November December".split(" ")[this.getMonth()])+(c?"":" "+b)}}return a?g?g:h:0<GWOthers.getItem("LAYOUT_SETTINGS","time_format")?(g?g+" ":"")+dateFormat(this,"hh:MM TT")+(h?" "+h:""):(g?g+" ":"")+this.getHours().toString().replace(e,"0$1")+":"+this.getMinutes().toString().replace(e,"0$1")+(h?" "+h:"")};
Date.prototype.toRelativeDateString=function(a){return this.isTomorrow()?getLang("CALENDAR::TOMORROW"):this.isToday()?getLang("CALENDAR::TODAY"):this.isYesterday()?getLang("CALENDAR::YESTERDAY"):this.toWMString(!0,!1,a,!0)};
Date.prototype.toRelativeTimeString=function(a){var b="",c=this.getFullYear()==(new Date).getFullYear();this.isTomorrow()&&(b=getLang("CALENDAR::TOMORROW"));this.isToday()&&(b=getLang("CALENDAR::TODAY"));this.isYesterday()&&(b=getLang("CALENDAR::YESTERDAY"));return b?this.toWMString(!1,!0,c,!0)+" "+b:this.toWMString(a,!1,c,!0)};Date.prototype.getUNIX=function(){return Math.floor(this.getTime()/1E3)};Date.prototype.setUNIX=function(a){this.setTime(1E3*a);return this};
Date.prototype.nextMonth=function(){this.setMonth(this.getMonth()+1,1);return this};Date.prototype.lastMonth=function(){this.setDate(0);return this};Date.prototype.lastDayOfMonth=function(){this.setMonth(this.getMonth()+1,0);return this};Date.prototype.isToday=function(){var a=new Date;return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()};
Date.prototype.isTomorrow=function(){var a=new Date;a.setDate(a.getDate()+1);return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()};Date.prototype.isYesterday=function(){var a=new Date;a.setDate(a.getDate()-1);return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()};Date.prototype.setGWTime=function(a,b){return this.setQTime(a,b?60*b:0)};
Date.prototype.setQTime=function(a,b){if("undefined"==typeof b||isNaN(b)||-1==b)b=0;var c,d,e;with(Math)c=floor(b/3600),d=floor(b%3600/60),e=b%3600%60;var f=parseJulianDate(a);this.setFullYear(f.year,f.month-1,f.day);this.setHours(c,d,e,0);return this};
Date.prototype.setUTCT=function(a){var b=/([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})(Z)?/g,c=b.exec(a);c||(c=b.exec(a));this[c[8]?"setUTCFullYear":"setFullYear"](1*("20"+c[1]),1*c[2]-1,1*c[3]);this[c[8]?"setUTCHours":"setHours"](1*c[4],1*c[5],1*c[6]);return this};
Date.prototype.setVersit=function(a,b){a=a.replace(/[\:\-]/g,"");var c=/([0-9]{4})([0-9]{2})([0-9]{2})(T([0-9]{2})([0-9]{2})([0-9]{2})(Z)?)?/g,d=c.exec(a);d||(d=c.exec(a));d&&(this[d[8]?"setUTCFullYear":"setFullYear"](1*d[1],1*d[2]-1,1*d[3]),d[5]=d[5]||0,d[6]=d[6]||0,d[7]=d[7]||0,this[d[8]?"setUTCHours":"setHours"](1*d[5],1*d[6],1*d[7]+(1*b||0)))};Date.prototype.getJulianDate=function(){return getJulianDate(this.getDate(),this.getMonth()+1,this.getFullYear())};
Date.prototype.getWeekOfYear=function(a){a="int"==typeof a?a:0;var b=new Date(this.getFullYear(),0,1),c=b.getDay()-a,c=0<=c?c:c+7,b=Math.floor((this.getTime()-b.getTime()-6E4*(this.getTimezoneOffset()-b.getTimezoneOffset()))/864E5)+1;4>c?(c=Math.floor((b+c-1)/7)+1,52<c&&(nYear=new Date(this.getFullYear()+1,0,1),nday=nYear.getDay()-a,nday=0<=nday?nday:nday+7,c=4>nday?1:53)):c=Math.floor((b+c-1)/7);return c};
function getJulianDate(a,b,c){var d,e,f,g;a*=1;b*=1;c*=1;with(Math)d=1585>=c?0:1,f=0>b-9?-1:1,e=-1*floor(7*(floor((b+9)/12)+c)/4),g=abs(b-9),f=floor(c+f*floor(g/7)),f=-1*floor(3*(floor(f/100)+1)/4),e=e+floor(275*b/9)+a+d*f;return e+1721027+2*d+367*c}
function parseJulianDate(a){var b,c,d,e,f={};with(Math)a=floor(a),a=floor(a+68569),b=floor(4*a/146097),a-=floor((146097*b+3)/4),c=floor(4E3*(a+1)/1461001),a=a-floor(1461*c/4)+31,d=floor(80*a/2447),e=a-floor(2447*d/80),a=floor(d/11);f.day=e;f.month=d+2-12*a;f.year=100*(b-49)+c+a;return f}function parseJulianTime(a){var b=(a-a%3600)/3600;a=Math.ceil(a%3600/60);a=10>a?"0"+a:a;return 0<GWOthers.getItem("LAYOUT_SETTINGS","time_format")?(b%12||12)+":"+a+(12>b?" AM":" PM"):b+":"+a}
var dateFormat=function(){var a=/d{1,4}|m{1,4}|D{3,4}|M{4}|yy(?:yy)?|([HhMsTtn])\1?|[LloZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){a=String(a);for(b=parseInt(b)||2;a.length<b;)a="0"+a;return a};return function(e,f){1==arguments.length&&("string"==typeof e||e instanceof String)&&!/\d/.test(e)&&(f=e,e=void 0);e=e?new Date(e):new Date;if(isNaN(e))throw"invalid date";
var g=dateFormat;f=String(g.masks[f]||f||g.masks["default"]);var h=e.getDate(),l=e.getDay(),k=e.getMonth(),m=e.getFullYear(),p=e.getHours(),q=e.getMinutes(),r=e.getSeconds(),v=e.getMilliseconds(),w=e.getTimezoneOffset(),u={d:h,dd:d(h),ddd:g.i18n.dayNames[l],dddd:g.i18n.dayNames[l+7],DDD:getLang("DATETIME::"+"SUN MON TUE WED THU FRI SAT".split(" ")[l]),DDDD:getLang("DATETIME::"+"SUNDAY MONDAY TUESDAY WEDNESDAY THURSDAY FRIDAY SATURDAY".split(" ")[l]),m:k+1,mm:d(k+1),mmm:g.i18n.monthNames[k],mmmm:g.i18n.monthNames[k+
12],MMMM:getLang("DATETIME::"+"JANUARY FEBRUARY MARCH APRIL MAY JUNE JULY AUGUST SEPTEMBER OCTOBER NOVEMBER DECEMBER".split(" ")[k]),yy:String(m).slice(2),yyyy:m,h:p%12||12,hh:d(p%12||12),H:p,HH:d(p),M:q,MM:d(q),n:q,nn:d(q),s:r,ss:d(r),l:d(v,3),L:d(99<v?Math.round(v/10):v),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:(String(e).match(b)||[""]).pop().replace(c,""),o:(0<w?"-":"+")+d(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4)};return f.replace(a,function(a){return a in u?
u[a]:a.slice(1,a.length-1)})}}();dateFormat.masks={"default":"ddd mmm d yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",imDateTime:"yyyy-mm-dd'T'HH:MM:ssZ",searchDate:"yyyy/mm/dd",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoFullDateTime:"yyyy-mm-dd'T'HH:MM:ss.lo",rfc2822:"ddd, dd mmm yyyy HH:MM:ss o",mediumDate:"m/d/yy HH:MM"};
dateFormat.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};Date.prototype.format=function(a){return dateFormat(this,a)};function arrayKeys(a){var b=[],c;for(c in a)null!=a[c]&&b.push(c);return b}
function inArray(a,b){if("undefined"!=typeof a.indexOf&&Is.Array(a))return a.indexOf(b);for(var c in a)if(a[c]==b)return c;return-1}function reverse(a){if(a.constructor==Array)return a.reverse();var b=[],c={},d;for(d in a)b.push(d);b.reverse();for(d in b)c[b[d]]=a[b[d]];return c}function arrConcat(){for(var a={},b=0;b<arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a}
function arrConcatValues(){for(var a=clone(arguments[0]),b=1;b<arguments.length;b++)for(var c in arguments[b])0>inArray(a,arguments[b][c])&&a.push(arguments[b][c]);return a}function mkArrayPath(a,b,c){"object"!=typeof b&&(b={});var d=b,e;for(e in a)2<arguments.length&&a.length-1==e?b[a[e]]=c:"object"!=typeof b[a[e]]&&(b[a[e]]={}),b=b[a[e]];return d}function arrayPath(a,b){for(var c in b)if(a=a[b[c]],"undefined"==typeof a)return;return a}
function arraySearch(a,b,c){var d="g",e=[];c&&(d="gi");if(!Is.Array(a)||!Is.String(b))return e;b=new RegExp(b.quoteMeta(),d);for(var f in a)a[f].match&&a[f].match(b)&&e.push(a[f]);return e}function substract(a){if(2>arguments.length)return a;for(var b,c,d=1;d<arguments.length;d++){b=arguments[d];for(var e in b)-1!=(c=inArray(a,b[e]))&&delete a[c]}return a}function getFreeKey(a){for(var b=0;;b++)if("undefined"==typeof a[b])return b}
function arrKeySlice(a,b){var c,d=!1,e=[];b.constructor==Array&&(d=!0);if(!a||!b)return d?e:compact(b);for(var f in b)c=d?b[f]:f,d||a[c]||!b[c]?"undefined"!=typeof a[c]&&(e[c]=a[c]):e[c]=b[c];return e}function compact(a){var b;if(Is.Array(a)){b=[];for(var c in a)a[c]&&b.push(a[c])}else for(c in b={},a)a[c]&&(b[c]=a[c]);return b}function count(a){var b=0;if("object"==typeof a){for(var c in a)b++;return b}return-1}
function arrayCompare(a,b){var c=0,d;for(d in a){if(a[d]!=b[d])return!1;c++}return count(b)==c?!0:!1}function buildURL(a){var b=[],c;for(c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}
function parseURL(a){var b,c=[];a||(a=self.location.href);-1<(b=a.indexOf("#"))&&(a=a.substr(0,b));-1<(b=a.indexOf("?"))&&b<a.indexOf("=")&&(a=a.substr(b+1));a=a.split("&");for(var d=0;d<a.length;d++){b=a[d].split("=");try{c[decodeURIComponent(b[0])]=decodeURIComponent(b[1])}catch(e){return[]}}return c}function parseFileSize(a){return(a=parseInt(a,10))&&Is.Number(a)?(a=Math.ceilFloat(a/1024,1),1024<a?Math.ceilFloat(a/1024,1)+" MB":a+" kB"):"0 kB"}
function relativeByteSize(a,b,c,d){c=c||0;b=b||0;d=d||1024;var e=document.documentElement.lang;relativeByteSize.unit||(relativeByteSize.unit=[getLang("generic::size_b"),getLang("generic::size_kb"),getLang("generic::size_mb"),getLang("generic::size_gb"),getLang("generic::size_tb"),getLang("generic::size_pb")]);var f={maximumFractionDigits:b},g=a/d;return 1<=g?relativeByteSize(g,b,++c,d):(+a).toLocaleString(e,f)+" "+relativeByteSize.unit[c]}
!function(a){var b;if("function"==typeof define&&define.amd&&(define(a),b=!0),"object"==typeof exports&&(module.exports=a(),b=!0),!b){var c=window.Cookies,d=window.Cookies=a();d.noConflict=function(){return window.Cookies=c,d}}}(function(){function a(){for(var a=0,c={};a<arguments.length;a++){var d=arguments[a],e;for(e in d)c[e]=d[e]}return c}return function c(d){function e(){}function f(c,f,g){if("undefined"!=typeof document){"number"==typeof(g=a({path:"/"},e.defaults,g)).expires&&(g.expires=new Date(1*
new Date+864E5*g.expires));g.expires=g.expires?g.expires.toUTCString():"";try{var m=JSON.stringify(f);/^[\{\[]/.test(m)&&(f=m)}catch(q){}f=d.write?d.write(f,c):encodeURIComponent(String(f)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);c=encodeURIComponent(String(c)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var m="",p;for(p in g)g[p]&&(m+="; "+p,!0!==g[p]&&(m+="="+g[p].split(";")[0]));return document.cookie=c+"="+f+
m}}function g(a,c){if("undefined"!=typeof document){for(var e={},f=document.cookie?document.cookie.split("; "):[],g=0;g<f.length;g++){var q=f[g].split("="),r=q.slice(1).join("=");c||'"'!==r.charAt(0)||(r=r.slice(1,-1));try{var v=q[0].replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent);if(r=(d.read||d)(r,v)||r.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent),c)try{r=JSON.parse(r)}catch(w){}if(e[v]=r,a===v)break}catch(w){}}return a?e[a]:e}}return e.set=f,e.get=function(a){return g(a,!1)},e.getJSON=function(a){return g(a,
!0)},e.remove=function(c,d){f(c,"",a(d,{expires:-1}))},e.defaults={},e.withConverter=c,e}(function(){})});function pushParameterToCallback(a,b){if(Is.Function(a[0]))Is.Array(a[1])?a[1].push(b):a[1]=[b];else if(Is.Object(a[0]))Is.Array(a[2])?a[2].push(b):a[2]=[b];else throw"pushParameterToCallback - Invalid argument";}function getCallbackFunction(a,b){if(Is.Function(a[0]))return a[0];if(Is.Function(a[1]))return a[1];if(b||!a[0]._destructed)try{return a[0][a[1]]}catch(c){return!1}else return!1}
function executeCallbackFunction(a){if(Is.Array(a)&&(Is.Object(a[0])&&(Is.String(a[1])||Is.Function(a[1]))||Is.Function(a[0])))try{var b;b=Is.Function(a[0])?1:2;for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);Is.Array(a[b])&&(c=c.concat(a[b]));for(d=b+1;d<a.length;d++)c.unshift(a[d]);var e;if(1==b)e=a[0].apply(null,c);else if(Is.Function(a[1]))e=a[1].apply(a[0],c);else if(e=a[0][a[1]].apply(a[0],c),1==a[0]._destructed)return!1;return e}catch(f){throw b="",b=Is.String(a[0])?"Error while executing "+
a[0]+"() in browser_ext:executeCallbackFunction()":"Error while executing "+(a[0]&&a[0]._pathName?a[0]._pathName:"oObject")+"."+a[1]+"() in browser_ext:executeCallbackFunction()",b+="\nCode:\n"+getCallbackFunction(a),b;}else return!1}
function createNameFromLocation(a){if(Is.Object(a)){var b=[];a.ITMFIRSTNAME&&b.push(a.ITMFIRSTNAME);a.ITMMIDDLENAME&&b.push(a.ITMMIDDLENAME);a.ITMSURNAME&&b.push(a.ITMSURNAME);a.ITMSUFFIX&&b.push(a.ITMSUFFIX);return(a.ITMTITLE?a.ITMTITLE+" ":"")+b.join(" ")}return""}
function parseNameToLocation(a,b){a=(a||"").trim();Is.Object(b)?(b.ITMCLASSIFYAS=a,b.ITMTITLE="",b.ITMFIRSTNAME="",b.ITMMIDDLENAME="",b.ITMSURNAME="",b.ITMSUFFIX=""):b={ITMCLASSIFYAS:a};if(!a.length)return b;for(var c,d,e=a.split(" "),f=e.length-1;-1<f;f--)(e[f]=e[f].trim())||e.splice(f,1);if(e.length){var g=getLang("NAME_PREFIX"),h={},l={};for(f in g)g[f]&&(h[g[f].toUpperCase()]=!0);g=getLang("NAME_SUFFIX");for(f in g)g[f]&&(l[g[f].toUpperCase()]=!0);for(;Is.String(e[0]);)if(h[e[0].toUpperCase()])b.ITMTITLE=
(b.ITMTITLE||"")+e.shift();else if(-1<(d=e[0].lastIndexOf(".")))d==e[0].length-1?b.ITMTITLE=(b.ITMTITLE||"")+e.shift():(c=e[0].split("."),e[0]=c.pop(),b.ITMTITLE=(b.ITMTITLE||"")+c.join(".")+".");else break;for(b.ITMFIRSTNAME=e.shift();;)if((c=e[e.length-1])&&(c.toUpperCase()===c||-1<(d=c.indexOf("."))||l[c.toUpperCase()]))-1<d?(c=c.split("."),c[0]&&c[1]?(b.ITMSUFFIX=c[1],e[e.length-1]=c[0]):b.ITMSUFFIX=e.pop()+(b.ITMSUFFIX?" "+b.ITMSUFFIX:"")):b.ITMSUFFIX=e.pop()+(b.ITMSUFFIX?" "+b.ITMSUFFIX:"");
else break;1<e.length&&0>e[0].indexOf(".")&&(b.ITMMIDDLENAME=e.shift());if(c=e.shift()){if(b.ITMSURNAME=c,c=e.join(" "))b.ITMSUFFIX=c+(b.ITMSUFFIX?" "+b.ITMSUFFIX:"")}else b.ITMMIDDLENAME?(b.ITMSURNAME=b.ITMMIDDLENAME,delete b.ITMMIDDLENAME):b.ITMFIRSTNAME&&(b.ITMSURNAME=b.ITMFIRSTNAME,delete b.ITMFIRSTNAME)}return b}function getPrimaryAccountFromAddress(){var a=dataSet.get("accounts",[sPrimaryAccount]);return a.FULLNAME?MailAddress.createEmail(a.FULLNAME,sPrimaryAccount):sPrimaryAccount}
function getSubobjects(a,b){b=b||{};for(var c in a)"_"!=c.charAt(0)&&"X_"!=c.substr(0,2)&&"x_"!=c.substr(0,2)&&("obj_tabs"==a[c]._type||"obj_tab"==a[c]._type?getSubobjects(a[c],b):b[c]=a[c]);return b}function getAuxiliarySubobjects(a,b){b=b||{};for(var c in a)"_"!=c.charAt(0)&&("X_"==c.substr(0,2)||"x_"==c.substr(0,2)?b[c]=a[c]:"obj_tabs"!=a[c]._type&&"obj_tab"!=a[c]._type||getAuxiliarySubobjects(a[c],b));return b}
function loadDataIntoForm(a,b){var c=getSubobjects(a),d;for(d in c)Is.Defined(b[d])&&"undefined"!=b[d]&&c[d]._value(b[d])}
function loadDataIntoFormOnAccess(a,b,c){var d=getSubobjects(a,d);if(b.USERACCESS||b.DOMAINADMINACCESS)var e=getAuxiliarySubobjects(a);for(var f in d){if(b.ACCESS[f])switch(b.ACCESS[f]){case "full":d[f]._value(b.VALUES[f]);break;case "view":d[f]._value(b.VALUES[f]);d[f]._disabled(!0);break;case "none":d[f]._main.parentNode.style.display="none"}b.DOMAINADMINACCESS&&!c&&e["x_"+f+"_set"]&&(e["x_"+f+"_set"].domadmin._value("view"==b.DOMAINADMINACCESS[f]?!0:!1),"view"==b.ACCESS[f]&&e["x_"+f+"_set"].domadmin._disabled(!0));
b.USERACCESS&&e["x_"+f+"_set"]&&(e["x_"+f+"_set"].user._value("view"==b.USERACCESS[f]?!0:!1),"view"==b.ACCESS[f]&&e["x_"+f+"_set"].user._disabled(!0))}}
function storeDataFromFormWithAccess(a,b,c){var d=getSubobjects(a);a=getAuxiliarySubobjects(a);var e,f;for(f in d)Is.Defined(e=d[f]._value())?b[f]=e:b[f]="",a["x_"+f+"_set"]&&a["x_"+f+"_set"].domadmin&&(c.DOMAINADMINACCESS||(c.DOMAINADMINACCESS={}),c.DOMAINADMINACCESS[f]=a["x_"+f+"_set"].domadmin._value()?"view":"full"),a["x_"+f+"_set"]&&(c.USERACCESS||(c.USERACCESS={}),c.USERACCESS[f]=a["x_"+f+"_set"].user._value()?"view":"full")}
function storeDataFromForm(a,b){var c=getSubobjects(a),d,e;for(e in c)Is.Defined(d=c[e]._value())?b[e]=d:b[e]=""}function firstIndex(a){if(Is.Object(a))for(var b in a)return b;return null}function firstValue(a){if(Is.Object(a))for(var b in a)return a[b];return null}function shiftObject(a){if(Is.Object(a))for(var b in a){var c=a[b];delete a[b];return c}return null}function isFormEmpty(a){for(var b in a)if(Is.Object(a[b])){if(!isFormEmpty(a[b]))return!1}else if(""!=a[b])return!1;return!0}
function translateFolder(a){switch(a){case "INBOX":return getLang("COMMON_FOLDERS::INBOX");case "__@@VIRTUAL@@__":return getLang("COMMON_FOLDERS::VIRTUAL-FOLDERS");default:return a}}_me=cColors.prototype;function cColors(){this.hexchars="0123456789ABCDEF"}_me.fast_contrast=function(a,b,c){return 128<(hex2dec(a.substr(1,2))+hex2dec(a.substr(3,2))+hex2dec(a.substr(5,2)))/3?b||"#000000":c||"#FFFFFF"};
_me.rgb2hsv=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.max(a,b,c),e=d-Math.min(a,b,c),f,g;if(0==e)g=f=0;else{g=e/d;var h=((d-a)/6+e/2)/e,l=((d-b)/6+e/2)/e,e=((d-c)/6+e/2)/e;a==d?f=e-l:b==d?f=1/3+h-e:c==d&&(f=2/3+l-h);0>f&&(f+=1);1<f&&--f}return[255*f,255*g,255*d]};
_me.rgb2hsl=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.min(a,b,c),e=Math.max(a,b,c),f=e-d,g,h=(e+d)/2;if(0==f)d=g=0;else{var d=.5>h?f/(e+d):f/(2-e-d),l=((e-a)/6+f/2)/f,k=((e-b)/6+f/2)/f,f=((e-c)/6+f/2)/f;a==e?g=f-k:b==e?g=1/3+l-f:c==e&&(g=2/3+k-l);0>g&&(g+=1);1<g&&--g}return[Math.ceil(255*g),Math.ceil(255*d),Math.ceil(255*h)]};
_me.isValidRGB=function(a){return!a[0]&&0!=a[0]||isNaN(a[0])||0>a[0]||255<a[0]||!a[1]&&0!=a[1]||isNaN(a[1])||0>a[1]||255<a[1]||!a[2]&&0!=a[2]||isNaN(a[2])||0>a[2]||255<a[2]?!1:!0};_me.hex2rgb=function(a){a=a.replace("#","");return[16*this.toDec(a.substr(0,1))+this.toDec(a.substr(1,1)),16*this.toDec(a.substr(2,1))+this.toDec(a.substr(3,1)),16*this.toDec(a.substr(4,1))+this.toDec(a.substr(5,1))]};_me.toDec=function(a){return this.hexchars.indexOf(a.toUpperCase())};
_me.rgb2hex=function(a,b,c){return this.toHex(a)+this.toHex(b)+this.toHex(c)};_me.toHex=function(a){a=parseInt(a||0,10);isNaN(a)&&(a=0);a=Math.round(Math.min(Math.max(0,a),255));return this.hexchars.charAt((a-a%16)/16)+this.hexchars.charAt(a%16)};colors=new cColors;function getActualEventTime(){var a=new Date,b=a.getJulianDate(),a=60*a.getHours()+a.getMinutes(),a=a-a%30;return{EVNSTARTDATE:b,EVNSTARTTIME:a,EVNENDDATE:b,EVNENDTIME:a+30}}
function arrToString(a){if(null===a)return"null";var b;switch(typeof a){case "string":return"'"+a.replace(/\'/g,"\\'")+"'";case "number":return a;case "object":var c=[],d=!1;if(Is.Array(a)){c.push("[");for(var e=0;e<a.length;e++)!1!==(b=arrToString(a[e]))&&(d&&c.push(","),c.push(b),d=!0);c.push("]")}else{c.push("{");for(e in a)!1!==(b=arrToString(a[e]))&&(d&&c.push(","),c.push("'"+e+"'",":",b),d=!0);c.push("}")}return c.join("");case "undefined":return!1}}
function valuesToString(a){var b="",c;for(c in a)b+=a[c]+"|";return b.substr(0,b.length-1)}
var MailAddress={createEmail:function(a,b){var c="";a&&(a=a.replace(/([\"\\])/g,"\\$1").trim(),c=-1<a.indexOf(" ")||-1<a.indexOf("\\")||-1<a.indexOf(",")||-1<a.indexOf(";")||-1<a.indexOf("@")||-1<a.indexOf("<")?'"'+a+'"':a);b&&(c&&(c+=" "),c+="<"+b.toLowerCase()+">");return c},appendEmail:function(a,b){if(b){if(!a)return b;var c=splitEmailsAndNames(b),d=splitEmailsAndNames(a);if((c=c[0])&&c.email){for(var e=d.length-1;-1<e;e--)if(d[e].email==c.email)return a;d.push(c);d=[];for(e=0;e<c.length;e++)d.push(createEmail(c[e].name,
c[e].email));return d.join(", ")}}return a},splitEmails:function(a){var b=[],c,d="",e=!1,f=!1,g=!1;if(Is.String(a)){for(var h=0;h<a.length;h++){c=a.charAt(h);switch(c){case ",":case ";":if(!e&&!f&&!g){(d=d.trim()).length&&(b.push(d),d="");continue}break;case '"':g||""!=d&&!e||(e=!e);break;case "[":e||g||(f=!0);break;case "]":f&&!g&&(f=!1);break;case "\\":if(!g){g=!0;d+=c;continue}case " ":if(""==d)continue}d+=c;g=!1}(d=d.trim()).length&&b.push(d)}return b},splitEmailsAndNames:function(a){var b=[];
a=MailAddress.splitEmails(a);for(var c={},d=0;d<a.length;d++)if(">"==a[d].charAt(a[d].length-1))for(var e="",f,g=!1,h=!1,l=0,k=a[d].length;l<k;l++){f=a[d].charAt(l);switch(f){case "<":if(!g&&!h){e=e.trim();(f=a[d].substring(l+1,k-1).trim())&&!c[f]&&(c[f]=!0,b.push({name:e,email:f}));l=k;continue}break;case '"':if(!h&&(""==e||g)){g=!g;continue}break;case "\\":if(!h){h=!0;continue}}e+=f;h=!1}else c[a[d]]||(c[a[d]]=!0,b.push({name:"",email:a[d]}));return b},splitNames:function(a){a=MailAddress.splitEmailsAndNames(a);
for(var b=[],c=0;c<a.length;c++)b.push(a[c].name||a[c].email);return b.join(", ")},findDistribList:function(a){var b,c,d,e,f,g,h={},l={},k;for(k in a)if(h[k]="",a[k]){b=MailAddress.splitEmails(a[k]);for(var m in b)if(c=b[m],"["==c.charAt(0)&&"]"==c.charAt(c.length-1)){c=c.substr(1,c.length-2);c=c.split("::");e=d="";f=[];switch(3>=c.length?c.length:3){case 3:d=c.shift();case 2:e=c.shift();case 1:for(var p in c)f.push(c[p]);g=f.join("::")}d||(d=sPrimaryAccount);e||(e="__@@ADDRESSBOOK@@__");l[d]||(l[d]=
{});l[d][e]||(l[d][e]={to:[],cc:[],bcc:[]});l[d][e][k].push(g)}else h[k]+=c+",";h[k]=h[k].substr(0,h[k].length-1)}h.distrib=l;return h}};function Path(){}Path.split=function(a){return Is.String(a)?(a=a.split("/"),[a.shift(),a.join("/")]):["",""]};Path.basename=function(a){return Is.String(a)?a.split("/").pop():!1};Path.basedir=function(a){if(!Is.String(a))return"";a=a.split("/");a.pop();return a.join("/")};Path.extension=function(a){return a&&-1!=a.indexOf(".")?a.split(".").pop().toLowerCase():""};
function Mapping(){}Mapping.getDefaultFolderForGWType=function(a){var b="";switch(a){case "C":case "L":b="contacts";break;case "E":b="events";break;case "J":b="journal";break;case "N":b="notes";break;case "T":b="tasks";break;case "F":b="files";break;default:throw Error("Not implemented");}return Path.split(GWOthers.getItem("DEFAULT_FOLDERS",b))[1]};
Mapping.getFormNameByGWType=function(a){switch(a){case "C":return"frm_contact";case "E":return"frm_event";case "N":return"frm_note";case "T":return"frm_task";case "J":return"frm_journal";case "L":return"frm_distrib";case "F":return"frm_file";default:throw Error("Not implemented");}};function toString(a){return void 0==a||null==a?"":a.toString()}function makeIDFromIDS(a,b){try{return[a[0],a[1],a[2][b]]}catch(c){}}function makeIDSFromID(a){return[a[0],a[1],[a[2]]]}
function getPathFromDataset(a){a=dataSet.get(a);for(var b in a)for(var c in a[b])return[b,c]}
window.currentBrowser=function(){var a="",b="",c=navigator.userAgent.toUpperCase();-1<c.indexOf("CHROME")?a="Chrome":-1<c.indexOf("WEBKIT")?(a="Safari",b=parseInt(c.substr(c.indexOf("SAFARI/")+7),10)):-1<c.indexOf("KHTML")?a="KHTML":-1<c.indexOf("OPERA")?a="Opera":-1<c.indexOf("MSIE 9")?a=document.documentMode&&9>document.documentMode?"MSIE7":"MSIE9":-1<c.indexOf("MSIE 10")?a="MSIE9":-1<c.indexOf("MSIE 7")?a="MSIE7":-1<c.indexOf("MSIE 8")?(a="MSIE7",b=8):-1<c.indexOf("MSIE 6.0")?a="MSIE6":-1<c.indexOf("TRIDENT/")?
a="MSIE11":-1<c.indexOf("GECKO")&&(a="Mozilla",b=parseInt(c.substr(c.indexOf("GECKO/")+6),10));return function(c){return c?b:a}}();function IsBrowserPluginInstalled(a){return navigator.mimeTypes&&navigator.mimeTypes[a]&&navigator.mimeTypes[a].enabledPlugin}var IWAPI={Attributes:function(){}};IWAPI.Attributes.prototype.setAttribute=function(a,b){var c={};c[a]=b;return this.setAttributes(c)};IWAPI.Attributes.prototype.getAttribute=function(a){return"attributeSet"in this?this.attributeSet[a]:null};
IWAPI.Attributes.prototype.removeAttribute=function(a){return"attributeSet"in this?this.attributeSet.removeItem(a):!1};IWAPI.Attributes.prototype.setAttributes=function(a){"attributeSet"in this||Object.defineProperty(this,"attributeSet",{enumerable:!1,writable:!1,configurable:!1,value:new IWAPI.Set});return this.attributeSet.addItems(a)};
IWAPI.XmlOptions=function(a,b,c){Object.defineProperty(this,"format",{enumerable:!1,writable:!0,configurable:!1,value:a||!1});Object.defineProperty(this,"changes",{enumerable:!1,writable:!0,configurable:!1,value:b||!1});Object.defineProperty(this,"reset",{enumerable:!1,writable:!0,configurable:!1,value:c||!1})};
IWAPI.Value=function(a,b){this.currentValue=this.initialValue=a;var c=!1;b&&Object.defineProperty(this,"label",{enumerable:!0,writable:!1,configurable:!1,value:b});Object.defineProperty(this,"value",{get:function(){return this.currentValue},set:function(a){this.readonly?console.warn("Attempt to change a readonly value of "+this.label):(this.currentValue=a,this.propertyClass=void 0!==a?"TPropertyString":"TPropertyNoValue")},enumerable:!1,configurable:!1});Object.defineProperty(this,"persist",{get:function(){return this.persistent},
set:function(a){this.persistent=a},enumerable:!1,configurable:!1});Object.defineProperty(this,"default",{get:function(){return this.defaultValue},set:function(a){this.defaultValue=a},enumerable:!1,configurable:!1});Object.defineProperty(this,"readonly",{get:function(){return c},set:function(a){c=a},enumerable:!1,configurable:!1});Object.defineProperty(this,"readOnly",{enumerable:!1,writable:!1,value:function(a){if("boolean"==typeof a)c=a;else return c}})};
IWAPI.Value.prototype.hasChanged=function(){return this.currentValue!=this.initialValue};IWAPI.Value.prototype.commitChanges=function(){this.initialValue=this.currentValue};IWAPI.Value.prototype.revertChanges=function(){this.currentValue=this.initialValue};IWAPI.Value.prototype.toString=function(){return void 0==this.currentValue?"":this.currentValue};
IWAPI.Value.prototype.toXMLString=function(a,b){a=a||new IWAPI.XmlOptions;if(a.changes&&!this.persistent&&!this.hasChanged())return"";var c=(a.format?b||"":"")+"<"+this.label,d=[];if(this.attributeSet)for(var e in this.attributeSet)d.push(e+'="'+this.attributeSet[e].toString().escapeXML(!0)+'"');return void 0==this.currentValue||null===this.currentValue?c+(d.length?" "+d.join(" "):"")+"/>"+(a.format?"\n":""):c+(d.length?" "+d.join(" "):"")+">"+this.currentValue.toString().escapeXML()+"</"+this.label+
">"+(a.format?"\n":"")};IWAPI.Value.prototype.setAttribute=IWAPI.Attributes.prototype.setAttribute;IWAPI.Value.prototype.getAttribute=IWAPI.Attributes.prototype.getAttribute;IWAPI.Value.prototype.removeAttribute=IWAPI.Attributes.prototype.removeAttribute;IWAPI.Value.prototype.setAttributes=IWAPI.Attributes.prototype.setAttributes;IWAPI.PersistentValue=function(a,b){this.persistent=!0;IWAPI.Value.apply(this,arguments)};IWAPI.PersistentValue.prototype=Object.create(IWAPI.Value.prototype);
IWAPI.Collection=function(a){Object.defineProperty(this,"collectionLabel",{enumerable:!1,writable:!1,configurable:!1,value:a})};
Object.defineProperty(IWAPI.Collection.prototype,"addItem",{enumerable:!1,writable:!1,value:function(a,b){a instanceof IWAPI.Value||a instanceof IWAPI.List||a instanceof IWAPI.Collection?b=b||a.label||a.listLabel||a.collectionLabel:"string"==typeof a?(a=new IWAPI.Value(b,a),b=a.label):console.warn("Collection items must have a label",b);if(!b||b in this)return!1;Object.defineProperty(this,b,{writable:!1,value:a,enumerable:!0,configurable:!0});return!0}});
Object.defineProperty(IWAPI.Collection.prototype,"removeItem",{enumerable:!1,writable:!1,value:function(a){delete this[a]}});Object.defineProperty(IWAPI.Collection.prototype,"countItems",{enumerable:!1,writable:!1,value:function(){return Object.keys(this).length}});Object.defineProperty(IWAPI.Collection.prototype,"readOnly",{enumerable:!1,writable:!1,value:function(a){if("boolean"==typeof a)for(var b in this)this[b].readOnly(a);else{for(b in this)if(this[b].readOnly())return!0;return!1}}});
Object.defineProperty(IWAPI.Collection.prototype,"hasChanged",{enumerable:!1,writable:!1,value:function(){for(var a in this)if(this[a].hasChanged())return!0;return!1}});Object.defineProperty(IWAPI.Collection.prototype,"commitChanges",{enumerable:!1,writable:!1,value:function(){for(var a in this)this[a].commitChanges()}});Object.defineProperty(IWAPI.Collection.prototype,"revertChanges",{enumerable:!1,writable:!1,value:function(){for(var a in this)this[a].revertChanges()}});
Object.defineProperty(IWAPI.Collection.prototype,"toString",{enumerable:!1,writable:!1,value:function(){return Object.keys(this).join()}});
Object.defineProperty(IWAPI.Collection.prototype,"toXMLString",{enumerable:!1,writable:!1,value:function(a,b){a=a||new IWAPI.XmlOptions;var c=[];if(this.attributeSet)for(var d in this.attributeSet)c.push(d+'="'+this.attributeSet[d].toString().escapeXML(!0)+'"');c=c.length?" "+c.join(" "):"";if(0==this.countItems())return(a.format?b:"")+"<"+this.collectionLabel+c+"/>"+(a.format?"\n":"");d=[];var e=b=b||"";b+="\t";for(var f in this)this[f].toXMLString&&d.push(this[f].toXMLString(a,b));return(a.format?
e:"")+"<"+this.collectionLabel+c+">"+(a.format?"\n":"")+d.join("")+(a.format?e:"")+"</"+this.collectionLabel+">"+(a.format?"\n":"")}});Object.defineProperties(IWAPI.Collection.prototype,{setAttribute:{value:IWAPI.Attributes.prototype.setAttribute},getAttribute:{value:IWAPI.Attributes.prototype.getAttribute},removeAttribute:{value:IWAPI.Attributes.prototype.removeAttribute},setAttributes:{value:IWAPI.Attributes.prototype.setAttributes}});
IWAPI.List=function(a){Array.apply(this,arguments);Object.defineProperty(this,"listLabel",{enumerable:!1,writable:!1,configurable:!1,value:a})};IWAPI.List.prototype=Object.create(Array.prototype);IWAPI.List.prototype.addItem=function(a,b){a instanceof IWAPI.List||a instanceof IWAPI.Collection||a instanceof IWAPI.Value||(a=new IWAPI.Value(b,a));this.push(a);return a};
IWAPI.List.prototype.removeItem=function(a){for(var b=this.length;b--;)if(this[b].label&&this[b].label==a||this[b].listLabel&&this[b].listLabel==a||this[b].collectionLabel&&this[b].collectionLabel==a){this.splice(b,1);break}};IWAPI.List.prototype.getItem=function(a){for(var b=this.length;b--;)if(this[b].label&&this[b].label==a||this[b].listLabel&&this[b].listLabel==a||this[b].collectionLabel&&this[b].collectionLabel==a)return this[b]};
IWAPI.List.prototype.getItems=function(a){for(var b=this.length,c=[];b--;)(this[b].label&&this[b].label==a||this[b].listLabel&&this[b].listLabel==a||this[b].collectionLabel&&this[b].collectionLabel==a)&&c.push(this[b]);return c};IWAPI.List.prototype.readOnly=function(a){var b=this.length;if("boolean"==typeof a)for(;b--;)this[b].readOnly(a);else for(;b--;)if(this[b].readOnly())return!0;return!1};
IWAPI.List.prototype.hasChanged=function(){for(var a=this.length;a--;)if(this[a].hasChanged())return!0;return!1};IWAPI.List.prototype.commitChanges=function(){for(var a=this.length;a--;)this[a].commitChanges()};IWAPI.List.prototype.revertChanges=function(){for(var a=this.length;a--;)this[a].revertChanges()};IWAPI.List.prototype.setAttribute=IWAPI.Attributes.prototype.setAttribute;IWAPI.List.prototype.getAttribute=IWAPI.Attributes.prototype.getAttribute;IWAPI.List.prototype.removeAttribute=IWAPI.Attributes.prototype.removeAttribute;
IWAPI.List.prototype.setAttributes=IWAPI.Attributes.prototype.setAttributes;
IWAPI.List.prototype.toXMLString=function(a,b){a=a||new IWAPI.XmlOptions;var c=[];if(this.attributeSet)for(var d in this.attributeSet)c.push(d+'="'+this.attributeSet[d].toString().escapeXML(!0)+'"');c=c.length?" "+c.join(" "):"";if(0==this.length)return(a.format?b:"")+"<"+this.listLabel+c+"/>"+(a.format?"\n":"");d=[];var e=b=b||"";b+="\t";for(var f in this)this[f].toXMLString&&d.push(this[f].toXMLString(a,b));return(a.format?e:"")+"<"+this.listLabel+c+">"+(a.format?"\n":"")+d.join("")+(a.format?e:
"")+"</"+this.listLabel+">"+(a.format?"\n":"")};IWAPI.Set=function(a){a&&Object.defineProperty(this,"setLabel",{enumerable:!1,writable:!1,configurable:!1,value:a})};IWAPI.Set.prototype=Object.create(null,{constructor:IWAPI.Set,addItem:{value:function(a){this.addItems(a)}},addItems:{value:function(a){for(var b in a)this[b]=a[b]}},removeItem:{value:function(a){return a in this?(delete this[a],!0):!1}}});IWAPI.Item=function(a,b){var c=new IWAPI.Collection(b||"item"),d;for(d in a)c.addItem(d,a[d]);return c};
function objConcat(a,b){for(var c in b)switch(typeof b[c]){case "object":break;case "function":break;default:a[c]=b[c]}for(c in b.prototype)a.prototype[c]=b.prototype[c];return a}Function.prototype.inherit=function(a){var b=0,c=this.prototype=new a;this.prototype.__uber=function(d){var e,f;e=b;f=a.prototype;if(e){for(;e;)f=f.constructor.prototype,--e;e=f[d]}else e=c[d],e==this[d]&&(e=f[d]);b+=1;f=e.apply(this,Array.prototype.slice.apply(arguments,[1]));--b;return f};return this};
function inherits(a){for(var b=1;b<arguments.length;b++){obj=arguments[b];for(var c in obj)switch(typeof obj[c]){case "object":break;case "function":break;default:a[c]=obj[c]}for(c in obj.prototype)a[c]=obj.prototype[c]}}
function clone(a,b,c){if("object"!=typeof a)return a;var d;try{d=new a.constructor}catch(f){d={}}if(c&&d.constructor===Array){var e=0;for(c=a.length;e<c;e++)b&&"object"==typeof a[e]?d.push(clone(a[e],!0)):d.push(a[e])}else for(e in a)try{d[e]=b&&"object"==typeof a[e]?clone(a[e],!0):a[e]}catch(f){}return d}
function compareObj(a,b,c){a=c?clone(a,!0):a;if("undefined"==typeof a)return"undefined"==typeof b;if("undefined"==typeof b||a.constructor!==b.constructor)return!1;if("object"!=typeof a)return a==b;for(var d in b)if(compareObj(a[d],b[d]))delete a[d];else return!1;for(d in a)return!1;return!0}
function inspect(a,b){var c="",d;for(d in a)try{c=a[d]===a?c+("obj."+d+" = SELF"):c+("obj."+d+" = "+a[d]+(b?"<br>":"\r\n"))}catch(e){c+="obj."+d+" = NO ACCESS"+(b?"<br>":"\r\n")}b?window.open("","").document.writeln(c):alert(c)}function inspect2(a,b){b?window.open("","").document.writeln(var_dump(a).replace(/\>/g,"&gt;").replace(/\</g,"&lt;").replace(/\n/g,"<br>")):alert(var_dump(a))}
function var_dump(a,b,c){var d="",e="",f="";c=c||0;if(Is.String(a))return a;for(f=0;f<c;f++)d+=".";for(var g in a)"object"==typeof a[g]?e=a[g].constructor==Date?e+(d+" ["+g+"](date) = "+a[g].toString()+"\n"):null==a[g]?e+(d+" ["+g+"](Null)\n"):a[g]._name&&a[g]._type?e+(d+" ["+g+"]("+a[g]._type+") = "+a[g]._name+"\n"):e+(d+" ["+g+"]\n"+var_dump(a[g],b,c+2)):(f="undefined"==typeof a[g]?"undefined":a[g].toString(),e+=d+" ["+g+"]("+typeof a[g]+") = "+f+"\n");return e}GlobalDebugger.version="1.3.3";
function GlobalDebugger(a){this.output=!0;this.console=!1;this.whiteboard=a||document.createElement("div");this.xml=!1;this.lognum=0;this.focus=!1;this.init()}
(function(){function a(a){this.title=a;this.wrap=!1;this.info=!0;this.warning=this.message=null;this.data=[]}var b=null,c=null,d=null;GlobalDebugger.browser=function(){var a={};a.application=navigator.userAgent.match(/(msie|firefox|chrome|safari|opera)/i);a.application=a.application instanceof Array?a.application[1]:null;var b=navigator.userAgent.match(/opr\/([0-9]+\.[0-9]+(\.[0-9]+)*)$/i);b instanceof Array&&(a.application="Opera",a.version=b[1]);a.engine=navigator.userAgent.match(/(trident|webkit|gecko|presto)/i);
a.engine=a.engine instanceof Array?a.engine[1]:null;b=/(AppleWebKit|Gecko|Trident|Presto)\/([0-9]+(\.[0-9]+)*)/;a.build=navigator.userAgent.match(b);a.build=a.build instanceof Array?a.build[2]:null;"Trident"!=a.engine||a.application||(a.application="MSIE");a.version||(b=/(version\/|firefox\/|chrome\/|msie |rv:)([0-9]+\.[0-9]+(\.[0-9]+)?)/i,a.version=navigator.userAgent.match(b),a.version=a.version instanceof Array?a.version[2]:null);a.release=parseInt(a.version)||0;return navigator.browser=a}();GlobalDebugger.os=
function(){var a={},b=navigator.userAgent;if(-1!=b.indexOf("Windows")||-1!=b.indexOf("Win9")){a.vendor="MicroSoft";a.name="Windows";var c=b.match(/Windows NT ([456]\.[012])/);if(c)a.version={"6.3":"8.1","6.2":"8","6.1":"7","6.0":"Vista","5.2":"Server 2003","5.1":"XP","5.0":"2000",NT:"NT"}[c[1]];else if(c=b.match(/Windows (NT|XP|2000|ME)/))a.version=c[1];else if(c=b.match(/Win(dows[ _])?(9[58]|NT)/))a.version=c[2]}else if(-1!=b.indexOf("Macintosh")){if(a.vendor="Apple",a.name="OS X",b=b.match(/Mac OS X 10[_.]([1-9])/))a.version=
"10."+b[1]}else if(-1!=b.indexOf("iPhone")||-1!=b.indexOf("iPad")||-1!=b.indexOf("iPod")){if(a.vendor="Apple",a.name="iOS",b=b.match(/OS ([1-9])_([0-9])/))a.version=b[1]+"."+b[2]}else if(-1!=b.indexOf("Android")){if(a.vendor="Google",a.name="Android",b=b.match(/Android ([1-9])\.([0-9]+)/))a.version=b[1]+"."+b[2]}else if(-1!=b.indexOf("Linux")||-1!=b.indexOf("X11"))a.name="Linux";return navigator.os=a}();a.prototype.publish=function(a){if(a){for(this.wrap&&(console.group?console.group(this.title):
console.info("---"+this.title+"------------------------------"));this.data.length;){a=this.data.shift();for(var f in a)if(a[f]instanceof Array)console[f](a[f][0],a[f][1]);else console[f](a[f])}this.wrap&&(console.groupEnd?console.groupEnd():console.info("---End----------------------------------------------------------------------"))}else{var g=function(a){var c=b.createElement("ul"),d;for(d in a){var e=b.createElement("li");try{e.innerHTML="<span>"+typeof a[d]+"</span> "+d+": "+h(a[d])}catch(f){e.innerHTML=
"<span>private</span> "+d+": <span>?</span>"}c.appendChild(e);e=e.lastChild;"A"==e.tagName&&(e.onclick=function(a,b){return function(a){a=g(b);this.parentNode.replaceChild(a,this)}}(d,a[d]))}return c},h=function(a){if("string"==typeof a)return"<q>"+a.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</q>";if("number"==typeof a&&!isNaN(a))return"<em>"+a+"</em>";if("boolean"==typeof a)return"<b>"+a+"</b>";if(null===a||void 0===a||"number"==typeof a&&
isNaN(a))return"<strong>"+a+"</strong>";if("object"==typeof a)return'<a href="javascript: void(0)">[object '+GlobalDebugger.getConstructor(a)+"]</a>";if("function"==typeof a){var b=/^function\s*[A-Z0-9_]*\([^)]*\)/i;return b.test(a)?"<var>"+b.exec(a).pop()+" { ... }</var>":"<var>"+a+"</var>"}return a};if(!d.parentNode||c&&!c.document){c=window.open("","debug","resizable=yes,scrollbars=1,status=0,width=400,height=600");c.document.write("<html><head><title>IceWarp Debug Logger</title><style>html,body{font:10px Tahoma,Arial,Helvetica,sans-serif;margin:0;padding:0} h1{width:100%} h1+form+div{padding-top:3em;padding-bottom:3em} form{text-align:center;border-top:1px solid #666;background-color:#444;width:100%;margin:0;padding:3px;opacity:0.7} input{border:1px solid #333;color:#c2f4a9;width:90%;background-color:#444;background-color:#111} div.debugbox{margin:7px 4px} div.debugdata{background-color:#424046;padding:4px 7px;border-radius:0 0 9px 9px} h2{margin:0;padding:3px;font-size:13px;background-color:#525056;cursor:pointer;text-shadow:1px 1px 2px #888} p{font-size:12px;color:#828086;margin:0;padding:0} q{color:#aef47b} em{color:#f06f9a} strong{color: #f4408c} b{color:#dbd956;font-weight:normal} var{color:#727076} ul{margin:0;padding:0;list-style:none;padding-left:1em} li{margin:0;padding:0;font-size:11px;color:#929096} li span{color: #626066} li a{color: #74a7e1}</style></head><body></body></html>");
c.document.close();c.document.title="IceWarp Debug Logger";c.document.body.onunload=function(){d=document.createElement("div")};b=c.document;f=b.createElement("h1");f.appendChild(b.createTextNode("JavaScript Debug Logging"));f.style.backgroundColor="black";f.style.color="white";f.style.margin="0";f.style.padding="7px";f.style.textAlign="center";f.style.font="bold 14px Arial,Helvetica,sans-serif";f.style.opacity="0.7";f.style.position="fixed";var l=[],k=0;a=b.createElement("form");a.onsubmit=function(a){a=
this.getElementsByTagName("input")[0];var b;l.unshift(a.value);try{if(window.execScript)try{execScript("GlobalDebugger.tmpIEexecVal=("+a.value+")"),b=GlobalDebugger.tmpIEexecVal}catch(c){execScript(a.value)}else b=eval.call(null,a.value);void 0!==b?debug.dump(b):debug.note("JavaScript executed, no return value")}catch(c){debug.note("JavaScript Execution Error")}a.value="";k=0;return!1};a.style.opacity="0.7";a.style.position="fixed";a.style.bottom="0px";var m=b.createElement("input");m.onkeydown=function(a){a=
a||c.event;if(!l.length)return!0;switch(a.keyCode){case 38:this.value=l[k];++k>=l.length&&(k=0);break;case 40:0>--k&&(k=l.length-1);this.value=l[k];break;case 27:this.value=""}};a.appendChild(m);d=b.body.appendChild(b.createElement("div"));b.body.appendChild(f);b.body.appendChild(a);b.body.appendChild(d);b.body.style.backgroundColor="#323036"}var p=b.createElement("div");p.className="debugbox";f=b.createElement("h2");f.appendChild(b.createTextNode(this.title));p.appendChild(f);a=b.createElement("div");
a.className="debugdata";this.warning&&(m=b.createElement("p"),m.appendChild(b.createTextNode(this.warning)),a.appendChild(m),m.style.color="#dbd956");if(this.info){var q=this.info;if("string"==typeof this.variable||"number"==typeof this.variable||"boolean"==typeof this.variable||"function"==typeof this.variable||null===this.variable||void 0===this.variable)q+=h(this.variable);m=b.createElement("p");m.innerHTML=q;a.appendChild(m);"object"==typeof this.variable&&a.appendChild(g(this.variable))}p.appendChild(a);
d.appendChild(p);f.onclick=function(a){"hidden"!=this.className?(this.nextSibling.style.display="none",this.className="hidden"):(this.nextSibling.style.display="block",this.className="")};c.scrollTo(0,b.body.scrollHeight);this.focus&&c.focus()}};GlobalDebugger.getType=function(a){return void 0===a?"undefined":null===a?"null":typeof a};GlobalDebugger.getClass=function(a){return null===a?"Null":void 0===a?"Undefined":Object.prototype.toString.call(a).slice(8,-1)};GlobalDebugger.getConstructor=function(a){var b=
/^function\s*([A-Z0-9_]+)\(/i,c=/^\[object ([A-Z0-9_]+)\]$/i;return"object"==typeof a&&null!==a?a instanceof Object&&a.constructor&&b.test(a.constructor.toString())?a.constructor.toString().match(b).pop():a.constructor&&c.test(a.constructor.toString())?a.constructor.toString().match(c).pop():a instanceof Date?"Date":a instanceof RegExp?"Array":a instanceof RegExp?"RegExp":"Object":!1};GlobalDebugger.prototype.init=function(){for(b=d=this.whiteboard;b.parentNode;)b=b.parentNode};GlobalDebugger.prototype.note=
function(b){if(this.output){var c=new a("IceWarp Debug Message");c.wrap=!0;c.data.push({info:b});c.info="";c.warning=b;c.publish(this.console)}};GlobalDebugger.prototype.dump=function(){if(this.output){var b,c;2==arguments.length?(c=arguments[1],b=arguments[0]):c=arguments[0];this.current={name:b,variable:c};var d=GlobalDebugger.getType(c),h=GlobalDebugger.getClass(c),l=GlobalDebugger.getConstructor(c);l&&(h=l,d="instance");l=new a("IceWarp Debug Log ("+ ++this.lognum+"): "+d+(b?" "+b:"")+" of type "+
h);l.wrap=!0;var k="Array"==h?" (lenght: "+c.length+")":"",h="String"==h||"Number"==h||"Boolean"==h?"":h+" ";if("null"==d||"undefined"==d||"number"==d&&isNaN(c))l.info="The value of the variable"+(b?" '"+b+"'":"")+" is ",l.warning="The value "+d+" is unspecified!";else if("function"==d)l.info=b?"The value of the variable '"+b+"' is ":"The value of this variable is ",l.warning="The variable is pointing to a function!";else if(c instanceof Date)l.info=b?"The parsed value of this Date '"+b+"' is ":"The parsed value of this Date is ",
c={Milliseconds:c.valueOf(),"Local time":c.toString(),"Julian date":c.getJulianDate?c.getJulianDate():void 0,"Unix time":c.getUNIX?c.getUNIX():void 0};else if(c instanceof RegExp)l.info=b?"The RegExp instance '"+b+"' holds the regex ":"This RegExp instance holds the regex ",c={Expression:c.source,"Current Position":c.lastIndex,"Multiple Matches":c.global,"Treat as one line":c.multiline,"Ignore Case":c.ignoreCase};else{var m=!1;if("object"==typeof c){var m=!0,p;for(p in c){m=!1;break}}m?(l.warning=
c instanceof Array?"This array is empty!":"This object is empty!",l.info=b?"The "+h+d+" '"+b+"' has no properties":"The "+h+d+" has no properties"):l.info=b?"The value of the "+h+d+" '"+b+"'"+k+" is: ":"The value of this "+h+d+k+" is: "}l.warning&&l.data.push({warn:l.warning});switch(d){case "string":case "number":case "null":case "undefined":l.data.push({info:[l.info,c]});break;default:l.data.push({info:l.info})}if(c instanceof Element&&this.console&&console.dirxml)l.data.push({dirxml:c});else if("object"==
typeof c&&this.console&&console.dir&&console.debug)if(-1!=navigator.userAgent.indexOf("WebKit"))for(var q in c)l.data.push({log:["\t"+q+": ",c[q]]});else l.data.push({dir:c});else if("object"==typeof c&&console.log&&this.console&&!console.debug)for(q in c)l.data.push({log:q+": "+c[q]});l.variable=c;l.varname=b;l.publish(this.console);return"Debug Dump Finished - Console mode"}};GlobalDebugger.prototype.see=function(){if(this.current)return this.current.variable};GlobalDebugger.prototype.open=function(a){this.dump(this.see()[a])};
GlobalDebugger.prototype.status=function(){};GlobalDebugger.prototype.info=function(b){b=new a("Browser Infomation");b.info="GlobalDebugger "+GlobalDebugger.version;b.variable=GlobalDebugger.browser;var c=new XMLHttpRequest;c?b.variable["XHR 2 Support"]={upload:"upload"in c,onload:"onload"in c,onabort:"onabort"in c,onerror:"onerror"in c,onprogress:"onprogress"in c,onloadend:"onloadend"in c}:b.variable.xhrsupport="none";b.variable["W3C Event Support"]={addEventListener:window.addEventListener?!0:!1};
b.variable["Class Attribute Manipulation Support"]={classList:document.documentElement.classList?!0:!1,getElementsByClassName:document.documentElement.getElementsByClassName?!0:!1};b.variable["General HTML5 Support"]={FormData:window.FormData?!0:!1};b.variable["XML Parsing Support"]={DOMParser:"DOMParser"in window?!0:!1,XMLSerializer:void 0!==typeof XMLSerializer?!0:!1};c=document.createElement("div");b.variable["Element Support"]={"textContent Property":void 0!==c.textContent?!0:!1,"innerText Property":void 0!==
c.innerText?!0:!1,"innerHTML Property":void 0!==c.innerHTML?!0:!1,"outerHTML Property":void 0!==c.outerHTML?!0:!1};b.publish(this.console)}})();var debug=new GlobalDebugger,_me=cTemplate.prototype;function cTemplate(){this.strict=!0}_me.tmp=function(a,b){return this.exe(storage.template(a),b)};_me.exe=function(a,b){this.sBuffer="";if(this.sTpl=a)return this.aData="object"==typeof b?arrConcat(storage.aStorage.language,b):storage.aStorage.language,this.parser(),this.sBuffer};
_me.variable=function(a,b){var c=arrayPath(this.aData,a.split("::"));return Is.Defined(c)?c:b?"{"+a+"}":""};_me.anchor=function(a){return(this.aData._ins||"")+"#"+a};
_me.parser=function(){for(var a,b,c,d;!(0>(a=this.sTpl.indexOf("{")));)if(this.sBuffer+=this.sTpl.substring(0,a),this.sTpl=this.sTpl.substring(a),1==(a=this.sTpl.indexOf("}")))this.sTpl=this.sTpl.substring(2);else switch(c=this.sTpl.substring(1,a),-1<(b=c.indexOf(" "))?(d=c.substring(b+1),c=c.substring(0,b)):d=null,this.sTpl=this.sTpl.substring(a+1),c){case "include":this.include(d);break;case "noptional":this.option(d,1);break;case "optional":this.option(d);break;case "dynamic":this.loop(d);break;
case "rdynamic":this.option(d,1);break;case "htmlspecialchars":this.sBuffer+=this.variable(d,this.strict).toString().escapeHTML();break;case "encodeURIComponent":this.sBuffer+=encodeURIComponent(this.variable(d,this.strict).toString());break;case "anchor":d&&(this.sBuffer+=this.anchor(d));break;case "lang":c=this.variable(d);default:this.sBuffer+=this.variable(c,this.strict)}this.sBuffer+=this.sTpl};
_me.option=function(a,b){var c=!1,d=this.part((b?"n":"")+"optional");if(-1<a.indexOf(" ")){var e=a.split(" "),f;for(f in e)if(this.variable(e[f])){c=!0;break}}else this.variable(a)&&(c=!0);if(!c&&!b||c&&b)this.sTpl=this.sTpl.substr(d)};
_me.include=function(a){var b=this.part("include");if(a){var c=this.sTpl.substr(0,b),d=new cTemplate,e;try{c.length&&(e=JSON.parse(c))}catch(f){console.log("template.include","JSON error:",c)}this.sTpl=d.tmp(a,e)+this.sTpl.substr(b)}else console.log("template.include","missing template"),this.sTpl=this.sTpl.substr(b)};
_me.loop=function(a,b){var c=this.part((b?"r":"")+"dynamic"),d=this.variable(a);if("object"!=typeof d)this.sTpl=this.sTpl.substr(c);else{b&&(d=reverse(d));var e=this.sTpl.substr(0,c),f="",g="",h=eval("/{"+a+"::\\*/g"),l=eval("/[ ]"+a+"::\\*/g"),k=eval("/::"+a+"::\\*/g"),m;for(m in d)g=e,-1<g.indexOf("{"+a+"::*")&&(g=g.replace(h,"{"+a+"::"+m)),-1<g.indexOf(" "+a+"::*")&&(g=g.replace(l," "+a+"::"+m)),-1<g.indexOf("::"+a+"::*")&&(g=g.replace(k,"::"+a+"::"+m)),f+=g;this.sTpl=f+this.sTpl.substr(c)}};
_me.part=function(a){var b="{"+a;a="{/"+a+"}";var c,d,e=0;for(d=0;!(0>(c=this.sTpl.indexOf(a,d)));)if(d=this.sTpl.indexOf(b,d),-1<d&&d<c)e++,d=this.sTpl.indexOf("}",d+1);else if(0<e)e--,d=c+a.length;else return this.sTpl=this.sTpl.substr(0,c)+this.sTpl.substr(c+a.length),c};template=new cTemplate;function cXMLTools(){this.noparse={"http://www.w3.org/1999/xhtml":!0}}
cXMLTools.prototype.XMLDoc=function(){try{if(window.ActiveXObject){if(this.prefix)return new ActiveXObject(this.prefix);for(var a,b=["Msxml2.DOMDocument.3.0","MSXML.DomDocument"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);this.prefix=b[c];break}catch(d){}if(this.prefix)return a;throw Error("cXMLTools.XMLDoc() - Could not find an installed XML parser");}if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument("","",null);throw!0;}catch(d){throw Error("Your browser does not support XmlDocument objects");
}};
cXMLTools.prototype.XML2Arr=function(a,b){for(var c={},d,e=0;;e++){if(0==e)var f=a.firstChild;else if(f.nextSibling)f=f.nextSibling;else{if(!b&&(!c||c.PARSERERROR&&c.PARSERERROR[0]))throw"XML parsing error: "+c.PARSERERROR[0].VALUE;return c}if(e||f.tagName){var g=f.tagName.toUpperCase();c[g]?(c[g].push({}),d=c[g].length-1):(d=0,c[g]=[{}]);var h=f.getAttribute("xmlns");if(h&&this.noparse[h])h=this.XML2Str(f),h=h.substring(h.indexOf(">")+1,h.lastIndexOf("<")),c[g][d].VALUE=h;else if(f.hasChildNodes())if(f.firstChild.nodeValue)for(h=f.firstChild,
c[g][d].VALUE=h.nodeValue;;)if(h=h.nextSibling)h.nodeValue&&(c[g][d].VALUE+=h.nodeValue);else break;else c[g][d]=this.XML2Arr(f,!0);if(f.attributes.length)for(c[g][d].ATTRIBUTES={},e=0;e<f.attributes.length;e++)c[g][d].ATTRIBUTES[f.attributes.item(e).nodeName.toUpperCase()]=f.attributes.item(e).nodeValue}}};
cXMLTools.prototype.Arr2XML=function(a,b,c){a=b?a:clone(a,!0);b||(this.xDoc=null,this.xDoc=this.XMLDoc());for(var d in a)for(var e in a[d]){if("Safari"!=currentBrowser()&&a[d][e].ATTRIBUTES&&(a[d][e].ATTRIBUTES.XMLNS||a[d][e].ATTRIBUTES.xmlns)&&this.xDoc.createElementNS){var f=this.xDoc.createElementNS(a[d][e].ATTRIBUTES.XMLNS||a[d][e].ATTRIBUTES.xmlns,c?d:d.toLowerCase());delete a[d][e].ATTRIBUTES.XMLNS;delete a[d][e].ATTRIBUTES.xmlns}else f=b&&b.namespaceURI&&this.xDoc.createElementNS?this.xDoc.createElementNS(b.namespaceURI,
c?d:d.toLowerCase()):this.xDoc.createElement(c?d:d.toLowerCase());if("object"==typeof a[d][e].ATTRIBUTES&&a[d][e].ATTRIBUTES.constructor!=Array){for(var g in a[d][e].ATTRIBUTES)f.setAttribute(c?g:g.toLowerCase(),a[d][e].ATTRIBUTES[g]);delete a[d][e].ATTRIBUTES}"undefined"!=typeof a[d][e].VALUE&&"object"!=typeof a[d][e].VALUE?"string"==typeof a[d][e].VALUE&&"Safari"==currentBrowser()&&526>currentBrowser(!0)?f.appendChild(this.xDoc.createTextNode(a[d][e].VALUE.escapeHTML())):f.appendChild(this.xDoc.createTextNode(a[d][e].VALUE)):
this.Arr2XML(a[d][e],f,c);if(b)b.appendChild(f);else{if("Opera"==currentBrowser())return f;this.xDoc.appendChild(f);return this.xDoc}}};
cXMLTools.prototype.Str2XML=function(a){var b=null;try{return b=this.XMLDoc(),b.async=!1,b.validateOnParse=!1,b.loadXML(a),b.parseError.errorCode&&alert("Error code: "+b.parseError.errorCode+"\nLine: "+b.parseError.line+":"+b.parseError.linePos+"\nReason: "+b.parseError.reason+"\n"+b.parseError.srcText),b}catch(c){return b=(new DOMParser).parseFromString(a,"text/xml"),this.stripWhiteSpace(b),b}};cXMLTools.prototype.XML2Str=function(a){try{return a.xml?a.xml:(new XMLSerializer).serializeToString(a)}catch(b){return""}};
cXMLTools.prototype.Str2Arr=function(a){try{return this.XML2Arr(this.Str2XML(a))}catch(b){console&&console.log("Str2Arr",b)}};cXMLTools.prototype.Arr2Str=function(a,b){try{return this.XML2Str(this.Arr2XML(a,null,b))}catch(c){console&&console.log("Arr2Str",c)}};cXMLTools.prototype.stripWhiteSpace=function(a){nodesToDelete=[];this.findWhiteSpace(a,0);for(var b=nodesToDelete.length-1;0<=b;b--)nodeRef=nodesToDelete[b],nodeRef.parentNode.removeChild(nodeRef);return a};cXMLTools.prototype.is_ws=function(a){return!/[^\t\n\r ]/.test(a.data)};
cXMLTools.prototype.findWhiteSpace=function(a,b){for(var c=0;c<a.childNodes.length;c++)3==a.childNodes[c].nodeType&&this.is_ws(a.childNodes[c])&&(nodesToDelete[nodesToDelete.length]=a.childNodes[c]),a.childNodes[c].hasChildNodes()&&this.findWhiteSpace(a.childNodes[c],c)};var XMLTools=new cXMLTools;XMLHttpRequest.prototype.getString=function(){return this.status&&200==this.status?this.responseText:""};
XMLHttpRequest.prototype.getXML=function(){try{return XMLTools.stripWhiteSpace(this.responseXML)}catch(a){throw"XMLHttpRequest.getXML \n"+this.getString();}};
XMLHttpRequest.prototype.getArray=function(){try{var a=this.getResponseHeader("Content-Type");switch(a){case "text/json":return window.JSON?window.JSON.parse(this.getString()):"Mozilla"==currentBrowser()?(new Function("return "+this.getString()))():eval("("+this.getString()+")");case "text/xml":case "application/xml":return XMLTools.XML2Arr(this.getXML());case null:case "null":return{};default:throw'unsupported content-type "'+a+'"';}}catch(b){throw"XMLHttpRequest.getArray \n"+("string"==typeof b?
b+"\n":"")+this.getString();}};function cRequest(a){this.sURL=a;this.iRetry=15}
cRequest.prototype._send=function(a,b,c,d,e){e=e||this.sURL;var f=c?!0:!1,g=this;e=e||this.sURL||"/";if(gui&&!gui.__online)return f&&gui.connection?gui.connection._queue(0,this.iRetry,[this,"_send",[a,b,c,d,e]],d):this.error({type:"response",text:"Offline",status:0,url:e}),!1;try{var h=new XMLHttpRequest}catch(l){throw"cRequest Your browser does not support XMLHttpRequest object";}h.open(a?"POST":"GET",e,f);a&&h.setRequestHeader("Content-Type",b||"text/xml");if(f){if(g.onstart)g.onstart();h.onabort=
function(f){if(g.onfinish)g.onfinish();try{0===f.target.status&&g._send(a,b,c,d,e)}catch(h){g.error({type:"system",text:"abort, unable to send"})}};h.onerror=function(f){if(g.onfinish)g.onfinish();try{0!=f.target.status||d&&executeCallbackFunction(d,this)||g.onerror&&g.onerror(this)||(gui&&gui.connection?gui.connection._queue(0,g.iRetry,[g,"_send",[a,b,c,d,e]],d):g.error({stype:"response",text:"Offline",status:0,url:e}))}catch(h){g.error({type:"system",status:f.target.status,text:"error, can not add to the buffer"})}};
h.onreadystatechange=function(){if(4==this.readyState){if(0!=this.status&&g.onfinish)g.onfinish();if(200!=this.status&&304!=this.status||null==this.getResponseHeader("Content-Type"))switch(this.status){case 0:break;case 404:case 500:gui.connection?gui.connection._queue(this.status,0,null,d):g.error({stype:"response",text:"Server Error",status:this.status,url:e});break;default:var f=g.iRetry;if(d&&executeCallbackFunction(d,this)||g.onerror&&g.onerror(this))break;case 503:f=parseInt(this.getResponseHeader("Retry-After"),
10)||f,gui.connection?gui.connection._queue(this.status,f,[g,"_send",[a,b,c,d,e]],d):g.error({stype:"response",text:"Server Error",status:this.status,url:e})}else{try{switch(f={},c[3]){case "XMLDocument":f=this.responseXML;case "XML":f={XML:this.getXML()};break;case "Text":f={Text:this.getString()};break;default:f={Array:this.getArray()}}}catch(h){throw"Response parse error: \n"+this.getString();}executeCallbackFunction(c,f);if(g.onsuccess)g.onsuccess(f)}}}}h.send(a||null);return f||200==h.status||
304==h.status?h:(g.error({type:"response",status:h.status}),!1)};cRequest.prototype.error=function(a){console&&console.dir&&console.dir(a)};cRequest.prototype.sendArray=function(a,b,c,d,e){return this._send(XMLTools.Arr2XML(a,"",e),"text/xml",b,c,d)};cRequest.prototype.sendJSON=function(a,b,c,d){return this._send(JSON.stringify(a),"application/json",b,c,d)};cRequest.prototype.sendString=function(a,b,c,d){return this._send(a,"text/plain",b,c,d)};
cRequest.prototype.sendXMLString=function(a,b,c,d){return this._send(a,"application/xml",b,c,d)};cRequest.prototype.get=function(a,b,c){return this._send(null,"",b,c,a)};cRequest.timer=new Date;cRequest.lapse=0;cRequest.interval=setInterval(function(){cRequest.lapse=(new Date-cRequest.timer)/1E3;cRequest.timer=new Date},15E3);function cDataSet(){this.aDataSets={};this.aListeners={}}
cDataSet.prototype.add=function(a,b,c,d,e){var f=!1;d||compareObj(this.get(a,b),c,!0)||(f=!0);Is.Array(b)?this.aDataSets[a]=mkArrayPath(b,this.aDataSets[a],c):this.aDataSets[a]=c;if(f)this.update(a,b,e);else if(!d)return!1;return!0};
cDataSet.prototype.remove=function(a,b,c,d){if("undefined"!=typeof this.aDataSets[a]){if(!b)delete this.aDataSets[a];else if(Is.Array(b))try{if("undefined"==typeof arrayPath(this.aDataSets[a],b))return;eval('delete this.aDataSets["'+a+'"]["'+b.join('"]["')+'"]')}catch(e){return!1}c||this.update(a,b,d);return!0}};cDataSet.prototype.get=function(a,b,c){if(a)if(a=this.aDataSets[a],Is.Array(b)){if(a)return a=arrayPath(a,b),c&&a?clone(a,1):a}else return c?clone(a,1):a};
cDataSet.prototype.obey=function(a,b,c,d){if("object"!=typeof a||!c)return!1;a[b||"_listener"]=c;this.aListeners[c]||(this.aListeners[c]=[]);this.aListeners[c].push(a);"undefined"==typeof this.aDataSets[c]||d||a.__update(c);return!0};cDataSet.prototype.disobey=function(a,b){b||(b="_listener");if("object"!=typeof a||!a[b]||!this.aListeners[a[b]])return!1;for(var c=this.aListeners[a[b]].length;c--;)this.aListeners[a[b]][c]===a&&this.aListeners[a[b]].splice(c,1);return!0};
cDataSet.prototype.update=function(a,b,c){if(a&&this.aListeners[a])for(var d in this.aListeners[a])try{if(c)if("string"==typeof c){if(this.aListeners[a][d]._pathName==c)continue}else if("object"==typeof c&&this.aListeners[a][d]._pathName==c._pathName)continue;this.aListeners[a][d].__update(a,b)}catch(e){}};dataSet=new cDataSet;
function cStorage(){this.aStorage={css:{},library:{},language:{},template:{},object:{}};this.ready={};this.aStorage.library={"client/inc/debug":!0,"client/inc/object_ext":!0,"client/inc/browser_ext":!0,"client/inc/template":!0,"client/inc/xmltools":!0,"client/inc/request":!0,"client/inc/dataset":!0,"client/inc/storage":!0,"client/inc/gui":!0,"client/inc/wm_base":!0,"client/inc/wm_generic":!0,"client/inc/wa_server":!0,"client/inc/wa_domains":!0,"client/inc/wa_accounts":!0,"client/inc/wm_auth":!0,"client/inc/wm_accounts":!0,
"client/inc/wm_folders":!0,"client/inc/wm_items":!0,"client/inc/wm_settings":!0,"client/inc/wm_storage":!0,"client/inc/init":!0,"client/inc/gw_others":!0,"client/inc/json":!0,"client/inc/popup":!0,"client/inc/obj_loader":!0,"client/inc/obj_form_generic":!0,"client/inc/obj_form_tab":!0,"client/inc/obj_button":!0,"client/inc/obj_connection":!0}}
cStorage.prototype.css=function(a,b){if(!b){if(this.aStorage.css.style)return!0;if(this.aStorage.css[a])return"disabled"==this.aStorage.css[a]&&(document.getElementById("css_"+a).disabled=!1,this.aStorage.css[a]=2),!0}this.aStorage.css[a]=1;var c=this,d={id:"css_"+a,rel:"stylesheet",type:"text/css",onload:function(){c.aStorage.css[a]&&(c.aStorage.css[a]=2)}};d.href="style"==a?"client/skins/"+GWOthers.getItem("LAYOUT_SETTINGS","skin")+"/css/style."+GWOthers.getItem("LAYOUT_SETTINGS","skin_style")+
".css":"scssphp/css.php?file=client/skins/"+GWOthers.getItem("LAYOUT_SETTINGS","skin")+"/css/"+a+".css";window.csscheck||(window.csscheck={});window.csscheck[a]=!1;d.onload=function(){window.csscheck[a]=!0};if(b){var e=document.getElementById("css_"+a);if(e)return e.href=d.href,!0}document.getElementsByTagName("head")[0].appendChild(mkElement("link",d));return!0};
cStorage.prototype.css_status=function(a){switch(this.aStorage.css.style||this.aStorage.css[a]){case "disabled":return"disabled";case 1:return"loading";case 2:return"loaded";default:return!1}};cStorage.prototype.remove_css=function(a){return this.aStorage.css[a]?("disabled"!=this.aStorage.css[a]&&(document.getElementById("css_"+a).disabled=!0,this.aStorage.css[a]="disabled"),!0):!1};
cStorage.prototype.remove_all_css=function(){var a,b;for(b in this.aStorage.css){if(a=document.getElementById("css_"+b))a.disabled=!0,a.parentNode.removeChild(a);delete this.aStorage.css[b]}};
cStorage.prototype.library=function(a,b,c){switch(b){case "skin":b="client/skins/"+GWOthers.getItem("LAYOUT_SETTINGS","skin")+"/inc/"+a;break;default:if(this.aStorage.library["client/inc/javascript"])return!0;b="client/inc/"+a}if(this.aStorage.library[b])return!0;if(c)request.get(b+".js",[this,"preloadLib",["library",b,a],"Text"]);else if(a=request.get(b+".js")){a=a.getString();if(1>a.length)return!1;pubEval(a);this.aStorage.library[b]="enabled"}return!0};
cStorage.prototype.preloadObj=function(){var a=request.get("client/objects/objects.xml");if(a){var a=a.getArray(),b;for(b in a.OBJECTS[0])this.object(b.toLowerCase(),a.OBJECTS[0][b][0])}};cStorage.prototype.preloadTpl=function(a,b){if(a&&b)if("templates"==b){if(a.Array&&a.Array.TEMPLATE&&a.Array.TEMPLATE[0])for(var c in a.Array.TEMPLATE[0])this.aStorage.template[c.toLowerCase()]=a.Array.TEMPLATE[0][c][0].VALUE||""}else this.aStorage.template[b]=a.Text||""};
cStorage.prototype.language=function(a){a=a||"en";if("undefined"!=typeof this.aStorage.language._ACTIVE_LANG&&this.aStorage.language._ACTIVE_LANG==a)return a;var b;try{b=request.get("client/languages/"+a+"/data.xml").getArray()}catch(f){b=null}if("en"!=a&&!Is.Object(b))try{a="en",b=request.get("client/languages/"+a+"/data.xml").getArray()}catch(f){b=null}if(!Is.Object(b))throw Error("cStorage.language() - bad language file syntax: "+a);this.aStorage.language={_ACTIVE_LANG:a};b=b.LANGUAGE[0];var c,
d,e;for(c in b)for(d in this.aStorage.language[c]={},b[c][0])"VALUE"!=d&&(e=1<b[c][0][d].length?b[c][0][d]:b[c][0][d][0].VALUE,this.aStorage.language[c][d]=Is.Defined(e)?e:"");return a};
cStorage.prototype.template=function(a,b){if("undefined"!=typeof this.aStorage.template[a])return this.aStorage.template[a];var c=GWOthers.getItem("LAYOUT_SETTINGS","skin"),d;if(b)return request.get("client/skins/"+c+"/templates/"+a+("templates"==a?".xml":".tpl"),[this,"preloadTpl",[a],"templates"==a?"Array":"Text"]),!0;if("templates"==a){if(d=request.get("client/skins/"+c+"/templates/templates.xml"))return this.preloadTpl({Array:d.getArray()},"templates"),!0}else if(d=request.get("client/skins/"+
c+"/templates/"+a+".tpl"))return this.aStorage.template[a]=d.getString();throw Error("cStorage.template() - blank template file: "+c+"/"+a);};
cStorage.prototype.object=function(a,b){if("undefined"!=typeof this.aStorage.object[a])return this.aStorage.object[a];try{b||(b=request.get("client/objects/"+a+".xml").getArray()),b.OBJECT&&(b=b.OBJECT[0])}catch(d){throw"cStorage.object() - blank xml: "+a;}if(b.CSS)for(var c in b.CSS)this.css(b.CSS[c].VALUE);if(b.BEFORE)for(c in b.BEFORE)b.BEFORE[c].ATTRIBUTES&&b.BEFORE[c].ATTRIBUTES.PATH?this.library(b.BEFORE[c].VALUE,b.BEFORE[c].ATTRIBUTES.PATH):this.library(b.BEFORE[c].VALUE);if(b.LIBRARY)for(c in b.LIBRARY)b.LIBRARY[c].ATTRIBUTES&&
b.LIBRARY[c].ATTRIBUTES.PATH?this.library(b.LIBRARY[c].VALUE,b.LIBRARY[c].ATTRIBUTES.PATH):this.library(b.LIBRARY[c].VALUE);return this.aStorage.object[a]=b};storage=new cStorage;
function getLang(a,b,c){if("string"!=typeof a||!a)return"";var d="",e=a.toUpperCase().split("::");try{d="undefined"==typeof e[1]?storage.aStorage.language[e[0]]:storage.aStorage.language[e[0]][e[1]];if("string"==typeof d){if(b&&d.length){var f=d.split("%s"),d=f.shift(),g;for(g in f)d+=b.shift()+f[g]}return d}if("object"==typeof d)return d}catch(h){}return 2==c?"":c?a:"{"+a+"}"}_me=cObject.prototype;
function cObject(a,b,c){this._name=a;this._type=b||"document";this._parent=c;this._pathName=this.__genPathName();this._destructed=!1;if(!b&&!c){var d=function(a){a=a||window.event;e.__exeEvent(a.type,a)};this._main=mkElement("div",{id:a});document.getElementsByTagName("body")[0].appendChild(this._main);this.__Y=this.__X=0;this.__UNIQ=unique_id();var e=this;AttachEvent(document,"onkeydown",function(a){(a.ctrlKey||a.metaKey)&&122==a.keyCode&&(document.fullscreenElement||document.mozFullScreenElement||
document.webkitFullscreenElement?document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))});
window.onresize=function(a){d(a)};this.__focus=!0;window.onfocus=function(a){e.__focus=!0;d(a)};window.onblur=function(a){e.__focus=!1;d(a)};this.__online=!0;document.body.ononline=function(a){e.__online=!0;d(a)};document.body.onoffline=function(a){e.__online=!1;d(a)};document.onclick=function(a){e.__focus||(e.__focus=!0);d(a)};document.onmousedown=d;document.onmouseup=function(a){e.__focus||(e.__focus=!0);d(a)};AttachEvent(document,"onmousewheel",function(a){a=a||window.event;d({type:"mousewheel",
delta:Is.Defined(a.detail)?a.detail:a.wheelDelta/-120})});document.onmousemove=function(a){a=a||window.event;e.__X=a.clientX;e.__Y=a.clientY;d(a)};document.onkeydown=function(a){a=a||window.event;d(a);if(27==a.keyCode){a.cancelBubble=!0;try{a.preventDefault()}catch(b){}try{a.stopPropagation()}catch(b){}return!1}122==a.keyCode&&(a.ctrlKey||a.metaKey)&&(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?
document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))};document.onkeyup=function(a){a=a||window.event;d(a);if(27==a.keyCode){a.cancelBubble=!0;try{a.preventDefault()}catch(b){}try{a.stopPropagation()}catch(b){}return!1}};
this.__loading_counter=0;this._loading=function(a){if(this.__loading_obj){a?this.__loading_counter++:0<this.__loading_counter&&this.__loading_counter--;try{this.__loading_obj._loading(this.__loading_counter)}catch(b){}}else this.__loading_counter=0};0===currentBrowser().indexOf("MSIE")&&setInterval(function(){0<e._main.scrollTop&&(e._main.scrollTop=0)},1E3)}this._anchors={main:""};this._template="";this._destructors={};this._events={};this._listener;this._listenerPath;this._saverPath=this._saver=
null;this._updateBuffer=this._norefresh=this._noupdate=this._skipsaving=!1}
_me._create=function(a,b,c,d,e){var f=storage.object(b);if(f.PARENTS){var g=!0,h;for(h in f.PARENTS[0].OBJ)if(this._type==f.PARENTS[0].OBJ[h].VALUE){g=!1;break}if(g)throw Error("gui._create() -  OBJ "+b+"\n disallowed parent "+this._type);}if(f.UNIQUE&&"undefined"!=typeof f.UNIQUE[0].VALUE){if("undefined"!=typeof this[a]){if("keep"==f.UNIQUE[0].VALUE)return this[a];this[a]._destruct()}}else{g="";for(h=0;;h++){if("undefined"==typeof this[a+g]){a+=g;break}g="_"+h}g=null}c=c||"main";this[a]=new cObject(a,
b,this);this[a].__attributes=e&&e.__attributes?e.__attributes:{};if(f.ANCHORS&&"undefined"!=typeof f.ANCHORS[0].ELM){var g="",l={};for(h in f.ANCHORS[0].ELM)g=f.ANCHORS[0].ELM[h].VALUE,l[g]=this._pathName+"."+a+"#"+g;this[a]._anchors=l}this[a]._anchor=c;var k;switch(f.TYPE?f.TYPE[0].VALUE:""){case "none":break;case "inline":k=mkElement("span");break;case "tr":k=mkElement("tr");break;case "td":k=mkElement("td");break;case "form":k=mkElement("form");k.onsubmit=function(){return!1};k.name=this[a]._pathName;
break;default:k=mkElement("div")}if(k){k.id=this[a]._pathName;if(!(h=this._getAnchor(c)))throw'Anchor "'+c+'" doesn\'t exist in "'+this._type+'" object';h.appendChild(k);h.getAttribute("scrollTop")&&"onobjectappend"==h.getAttribute("scrolltop")&&h.scrollTop&&(h.scrollTop=0);h=null;this[a]._allcss=k.className=(f.ATTRIBUTES&&f.ATTRIBUTES.CSS?f.ATTRIBUTES.CSS+" ":"")+b+(d?" "+d:"");this[a]._main=k;k=null;if(this[a].__attributes)for(var m in this[a].__attributes)"iw-"!=m.substr(0,3)&&"style"!=m||this[a]._main.setAttribute(m,
this[a].__attributes[m])}this[a]._css=d;k=[];for(h=4;h<arguments.length;h++)k.push(arguments[h]);if(f.BEFORE)for(h in f.BEFORE)if(m=f.BEFORE[h].ATTRIBUTES&&f.BEFORE[h].ATTRIBUTES.CLASS?f.BEFORE[h].ATTRIBUTES.CLASS:f.BEFORE[h].VALUE,"function"==typeof window[m]&&(inherits(this[a],window[m]),window[m].prototype.__constructor&&!1===this[a].__constructor.apply(this[a],k)))return!1;f.TEMPLATE&&"undefined"!=typeof f.TEMPLATE[0].VALUE&&(this[a]._template=f.TEMPLATE[0].VALUE,Is.Defined(this._parent)&&Is.Defined(this._parent._aTemplateData)?
this[a]._draw(null,null,this._parent._aTemplateData):Is.Defined(this._aTemplateData)?this[a]._draw(null,null,this._aTemplateData):this[a]._draw());if(f.ONUNLOAD)for(h in f.ONUNLOAD)this[a]._add_destructor(f.ONUNLOAD[h].VALUE,f.ONUNLOAD[h].ATTRIBUTES);if(f.LIBRARY)for(h in f.LIBRARY){if(this[a]&&this[a]._destructed)return;m=f.LIBRARY[h].ATTRIBUTES&&f.LIBRARY[h].ATTRIBUTES.CLASS?f.LIBRARY[h].ATTRIBUTES.CLASS:f.LIBRARY[h].VALUE;"function"==typeof window[m]&&(inherits(this[a],window[m]),window[m].prototype.__constructor&&
this[a].__constructor.apply(this[a],k))}this[a]&&this[a]._finished&&this[a]._finished();this.__onCreateChild&&this.__onCreateChild(a,b,c,d);return this[a]};_me.__genPathName=function(){var a=this._name;this._parent&&this._parent._pathName&&(a=this._parent._pathName+"."+a);return a};
_me._draw=function(a,b,c,d){"object"!=typeof c?c={_ins:this._pathName}:c._ins=this._pathName;GWOthers&&(c._skin="client/skins/"+GWOthers.getItem("LAYOUT_SETTINGS","skin"));var e=template.tmp(a?a:this._template,c),f,g=[],h=[],l,k;if(-1<e.indexOf("<obj ")){"undefined"!=typeof ActiveXObject&&"MSIE7"==currentBrowser()?(l=!0,k=XMLTools.Str2XML("<root>"+e.replace(/\&/g,"&amp;")+"</root>")):(l=!1,k=mkElement("backquote"),("Safari"==currentBrowser()||"Chrome"==currentBrowser())&&-1<e.indexOf("<title")&&(e=
e.replace(/\<title/ig,"<safari_title").replace(/\<\/title/ig,"</safari_title")),k.innerHTML=e);e=k.getElementsByTagName("obj");if(e.length){for(var m=function(a){var b,c=a.getElementsByTagName("item"),d=[],e={};if(!c.length)return a.textContent||("string"==typeof a.text?a.text.unescapeHTML():null);a=0;for(var f=c.length;a<f;a++)(b=c[a].getAttribute("key"))?e[b]=m(c[a]):d.push(m(c[a]));return Is.Empty(e)?d:e},p,q,r,v=0,w=[],u=0;u<e.length;u++)if(p=e[u].parentNode,r=e[u].getAttribute("type"),(q=e[u].getAttribute("name"))&&
r){if("obj"==p.tagName.toLowerCase())t=e[u].getAttribute("anchor")||"main";else if(f=p.getAttribute("id")){if(t=inArray(this._anchors,f),-1==t){do t=Math.rand();while(this._anchors[t]);this._anchors[t]=f}}else{do t=Math.rand();while(this._anchors[t]);this._anchors[t]=(this._pathName||"")+"#"+t;p.setAttribute("id",this._anchors[t])}h={type:r,name:q,anchor:t,attr:{}};e[u].attributes&&Array.prototype.slice.call(e[u].attributes).forEach(function(a){h.attr[a.name]=a.value});if(f=e[u].getAttribute("css"))h.css=
f;if(f=e[u].getAttribute("width"))h.width=f;if(f=e[u].getAttribute("height"))h.height=f;if(f=e[u].getAttribute("tabindex"))h.tabindex=f;if(f=e[u].getAttribute("tabcontainer"))h.tabcontainer=f;e[u].getAttribute("focus")&&(h.focus=!0);e[u].getAttribute("ondemand")&&(h.ondemand=!0);for(r=e[u].childNodes.length-1;0<=r;r--)if(q=e[u].childNodes[r],f=q.tagName?q.tagName.toLowerCase():"")switch(f){case "readonly":q=q.textContent||("string"==typeof q.text?q.text.unescapeHTML():"");!q||"false"==q&&"0"==q||
(h[f]=!0);break;case "disabled":q=q.textContent||("string"==typeof q.text?q.text.unescapeHTML():"");h[f]=!q||"false"==q&&"0"==q?!1:"true"==q||"disabled"==q||"1"==q?!0:q.replace(/,/gi,";").split(";");break;case "draw":h.draw=[q.getAttribute("form"),q.getAttribute("anchor")||"main",m(q)];break;case "safari_title":f="title";case "enabled":case "restrictions":case "init":case "fill":case "filllang":case "value":case "src":case "title":case "text":case "class":case "placeholder":case "placeholderplain":case "baseunit":case "maxunit":case "label":case "toggle":case "enables":h[f]=
m(q)}q=null;if("obj"==p.tagName.toLowerCase()){for(f=e.length-1;0<=f&&e[f]!==p;f--);w[f].objects?w[f].objects.push(h):w[f].objects=[h]}else g[++v]=h;w.push(h);h=null}w=null;for(p=e.length-1;0<=p;p--)v=e[0].ownerDocument.createTextNode(""),e[p].parentNode.appendChild(v),e[p].parentNode.removeChild(e[p]),v=null}l?(e=XMLTools.XML2Str(k).replace(/\&amp;/g,"&"),e=e.substring(6,e.lastIndexOf("</root>"))):e=k.innerHTML;k=p=null}else var t=b;l=!1;if(d)for(d=document.createElement("div"),d.innerHTML=helper.trim(e),
d.firstChild&&(l=d.firstChild);d.firstChild;)a&&t?this._getAnchor(b).appendChild(d.firstChild):this._main.innerHTML.appendChild(d.firstChild);else a&&t?(this._getAnchor(b).innerHTML=e,l=this._getAnchor(b)):(this._main.innerHTML=e,l=this._main.innerHTML);delete c._ins;Is.Empty(c)?this.__addObjects(g):this.__addObjects(g,null,c);this.__onCreateChild&&this.__onCreateChild("","",b);return l};
_me.__addObjects=function(a,b,c){var d;b=b?eval(b):this;c&&(this._aTemplateData=c);for(var e in a){d=[a[e].name,a[e].type,a[e].anchor,a[e].css,{__attributes:a[e].attr?a[e].attr:{}}];if(a[e].init)if("object"==typeof a[e].init)for(var f in a[e].init)d.push(a[e].init[f]);else d.push(a[e].init);this._aTemplateData&&b&&(b._aTemplateData=c);d=b._create.apply(b,d);a[e].title&&Is.Function(d._title)&&d._title(a[e].title);a[e].text&&Is.Function(d._text)&&d._text(a[e].text);a[e].fill&&Is.Function(d._fill)&&
d._fill(a[e].fill);a[e].filllang&&Is.Function(d._fillLang)&&d._fillLang(a[e].filllang);a[e].value&&Is.Function(d._value)&&d._value(a[e].value);a[e].src&&Is.Function(d._src)&&d._src(a[e].src);a[e].readonly&&Is.Function(d._readonly)&&d._readonly(a[e].readonly);a[e].toggle&&Is.Function(d._toggle)&&d._toggle(a[e].toggle);a[e].enables&&Is.Function(d._enables)&&d._enables(a[e].enables);a[e].disabled&&Is.Function(d._disabled)&&d._disabled(a[e].disabled);a[e].enabled&&Is.Function(d._disabled)&&(!1===a[e].enabled||
"0"==a[e].enabled||"disabled"==a[e].enabled?d._disabled(!0):(d._disabled(a[e].enabled.replace(/,/gi,";").split(";")),d._disabled(!1)));a[e].placeholder&&Is.Function(d._placeholder)&&d._placeholder(a[e].placeholder);a[e].placeholderplain&&Is.Function(d._placeholder)&&d._placeholder(a[e].placeholderplain,!0);a[e].baseunit&&Is.Function(d._baseunit)&&d._baseunit(a[e].baseunit);a[e].maxunit&&Is.Function(d._maxunit)&&d._maxunit(a[e].maxunit);a[e].label&&Is.Function(d._label)&&d._label(a[e].label);a[e]["class"]&&
Is.Function(d._class)&&d._class(a[e]["class"]);a[e].tabindex&&Is.Function(d._tabIndex)&&d._tabIndex(a[e].tabcontainer,"true"==a[e].tabindex?void 0:parseInt(a[e].tabindex,10));a[e].focus&&Is.Function(d._focus)&&d._focus(a[e].focus);(a[e].width||a[e].height)&&Is.Function(d._size)&&d._size(a[e].width,a[e].height);if(a[e].restrictions&&Is.Function(d._restrict)){var g=[];if("object"==typeof a[e].restrictions)for(f in a[e].restrictions)g.push(a[e].restrictions[f],f);else"string"==typeof a[e].restrictions&&
g.push(a[e].restrictions);try{g.length&&d._restrict.apply(d,g)}catch(h){throw"invalid input array for restrictions in:\n"+b._pathName+"."+a[e].name;}}a[e].draw&&Is.Function(d._draw)&&("undefined"!=typeof d.__drawTpl&&!d._isActive&&a[e].ondemand?(d.__drawTpl=a[e].draw,d.__drawData=c):(c=arrConcat(c,a[e].draw[2]),d._draw(a[e].draw[0],a[e].draw[1],c),d._isActive&&d._active&&d._active(!0)));a[e].objects&&a[e].objects.length&&("undefined"!=typeof d.__drawObj&&!d._isActive&&a[e].ondemand?(d.__drawObj=a[e].objects,
d.__drawData=c):(this.__addObjects(a[e].objects,d._pathName,c),d._isActive&&d._active&&d._active(!0)))}};_me._obeyEvent=function(a,b,c){this._events[a]?this._disobeyEvent(a,b):this._events[a]={};var d=unique_id();this._events[a][d]=[b,c];return d};
_me._disobeyEvent=function(a,b){var c=getCallbackFunction(b,!0);if(Is.Function(c)){if(!this._events[a])return!0;for(var d in this._events[a])if(this._events[a][d]){var e=this._events[a][d][0];if(Is.Function(e[0])&&Is.Function(b[0])&&e[0]===b[0]||Is.Function(e[1])&&Is.Function(b[1])&&e[0]===b[0]&&e[1]===b[1]||e[0]._pathName==b[0]._pathName&&c===getCallbackFunction(e,!0))return delete this._events[a][d],!0}}return!1};
_me.__exeEvent=function(a,b,c){if(this._events[a])for(var d in this._events[a])try{"undefined"!=typeof this._events[a][d]&&Is.Object(this._events[a][d][0])&&!1!==executeCallbackFunction(this._events[a][d][0],b,c)||delete this._events[a][d]}catch(e){gui._REQUEST_VARS.frm&&console&&console.log&&console.log("exeEvent",e),delete this._events[a][d]}};_me._getChildObjects=function(a,b){var c=[],d;for(d in this)0!=d.indexOf("_")&&this[d]&&(a&&this[d]._anchor!=a||b&&this[d]._type!=b||c.push(this[d]));return c};
_me._clean=function(a,b){var c=this._getChildObjects(a,b),d;for(d in c)c[d]._destruct();return!0};_me._getAnchor=function(a){if(this._anchors[a])return document.getElementById(this._anchors[a]);if("main"==a)return this._main;var b=document.getElementById(this._pathName+(a?"#"+a:""));b||console.log('anchor "'+a+'" not found');return b};_me._listen=function(a,b,c){this._listener=a;"object"==typeof b&&(this._listenerPath=b);dataSet.obey(this,"_listener",a,c)};
_me._save=function(a,b){this._saver=a;"object"==typeof b&&(this._saverPath=b);dataSet.obey(this,"_saver",a)};_me._saveme=function(a){if(this._skipsaving)return"";this._noupdate&&(a=this._noupdate);if(this._saver)return dataSet.add(this._saver,this._saverPath,this._value(),a,this._pathName),this._saver;if(this._listener)return dataSet.add(this._listener,this._listenerPath,this._value(),a,this._pathName),this._listener};
_me._add_destructor=function(a,b){if("undefined"==typeof a)return!1;"function"==typeof a?this._destructors["function_"+b]=a:this._destructors[a]=b};_me._remove_destructor=function(a,b){b?delete this._destructors["function_"+b]:delete this._destructors[a]};
_me._destruct=function(){if(!this._destructed){this._destructed=!0;if(!this._parent[this._name])return!1;for(var a in this._destructors){if("function"==typeof this._destructors[a])this._destructors[a]();Is.Function(this[a])&&this[a].apply(this,Is.Array(this._destructors[a])?this._destructors[a]:arguments)}for(var b in this)0!=b.indexOf("_")&&"object"==typeof this[b]&&null!=this[b]&&"function"==typeof this[b]._destruct&&(this[b]._destruct(),delete this[b]);this._listener&&dataSet.disobey(this);this._listener_data&&
dataSet.disobey(this,"_listener_data");this._main&&this._main.parentNode&&this._main.parentNode.removeChild(this._main);this._parent[this._name]=null;delete this._parent[this._name];this._parent.__onDestroyChild&&this._parent.__onDestroyChild(this._name,this._type,this._anchor)}};function IWServerInteraction(){}
IWServerInteraction.prototype.wrapQuery=function(a,b){var c=new IWAPI.Collection("iq");c.setAttributes({sid:dataSet.get("main",["sid"]),type:b||"get",format:"application/xml"});c.addItem(a);return c};IWServerInteraction.prototype.createCommand=function(a,b){var c=new IWAPI.Collection("query");c.setAttribute("xmlns","admin:iq:"+this.xmlns);c.addItem(new IWAPI.PersistentValue(a,"commandname"));c.addItem(new IWAPI.Collection("commandparams"));for(var d in b)this.compileItems(c.commandparams,d,b);return c};
IWServerInteraction.prototype.compileItems=function(a,b,c){if("string"==typeof c[b]||"number"==typeof c[b])a.addItem(new IWAPI.PersistentValue(c[b],b));else if(c[b]instanceof Array){c=c[b];b=new IWAPI.List(b);for(var d=0,e=c.length;d<e;d++)if("string"==typeof c[d])b.addItem(new IWAPI.PersistentValue(c[d],"item"));else{var f=new IWAPI.Collection("item"),g;for(g in c[d])this.compileItems(f,g,c[d]);b.addItem(f)}a.addItem(b)}else if("object"==typeof c[b]){c=c[b];f=new IWAPI.Collection(b);for(g in c)this.compileItems(f,
g,c);a.addItem(f)}};IWServerInteraction.prototype.sendRequest=function(a,b){request.sendXMLString(this.wrapQuery(a).toXMLString(new IWAPI.XmlOptions(!0)),[this,"response_check",[b]])};IWServerInteraction.prototype.setValues=function(a,b){request.sendXMLString(this.wrapQuery(a,"set").toXMLString(new IWAPI.XmlOptions(!0,!0)),[this,"parseResponse",[b],"XML"],[this,"resultfail"])};
IWServerInteraction.prototype.resetValues=function(a,b){request.sendXMLString(this.wrapQuery(a,"set").toXMLString(new IWAPI.XmlOptions(!0,!1,!0)),[this,"parseResponse",[b],"XML"],[this,"resultfail"])};IWServerInteraction.prototype.executeCommand=function(a,b){request.sendXMLString(this.wrapQuery(a,"set").toXMLString(new IWAPI.XmlOptions(!0)),[this,"parseResponse",[b],"XML"],[this,"resultfail"])};
IWServerInteraction.prototype.getResult=function(a,b){request.sendXMLString(this.wrapQuery(a).toXMLString(new IWAPI.XmlOptions(!0)),[this,"parseResponse",[b],"XML"],[this,"resultfail"])};
IWServerInteraction.prototype.parseXML=function(a,b){if(b){do{var c=b.nodeName.toLowerCase();null===b.firstElementChild?a.addItem(c,b.firstChild?b.textContent:null):(c="item"==b.firstElementChild.nodeName?new IWAPI.List(c):new IWAPI.Collection(c),a.addItem(c),this.parseXML(c,b.firstElementChild))}while(b=b.nextSibling)}};
IWServerInteraction.prototype.parseResponse=function(a,b,c){b=b.XML.documentElement;a=b.getAttribute("type");if("result"==a)a=b.getElementsByTagName("result")[0],a.firstChild&&!a.firstElementChild&&3==a.firstChild.nodeType?c(a.textContent):a.firstChild?(b=new IWAPI["item"==a.firstChild.nodeName?"List":"Collection"]("result"),this.parseXML(b,a.firstChild),c(b)):c("");else if("error"==a)switch(a=b.getElementsByTagName("error")[0].getAttribute("uid"),a){case "session_invalid":case "session_invalid_id":case "session_expired":case "session_no_user":try{dataSet.add("main",
["sid"],""),logout(!0)}catch(d){log.error(d)}c();break;case "invoker_commandname_invalid":gui.message.error(getLang("error::invalid_command"));break;default:c({error:a})}};
var wm_generic=function(){function a(){this.xmlns="rpc";this.error=!1}a.prototype=Object.create(IWServerInteraction.prototype);a.prototype.__publish=function(a){window.com=window.com||{};window.com[a]=this};a.prototype.create_iq=function(a,c,d,e,f,g,h,l){d=d||!1;e=e||"get";f=f||"123";h=h||!1;delete this.error;g=g||this.xmlns;if(!{auth:1,tools:1,accounts:1,folders:1,items:1,freebusy:1,spellchecker:1,"public":1,"private":1,domain:1,message:1,"import":1,"export":1,upload:1,rpc:1}[g])throw Error('create_iq: unsupported xmlns "'+
g+'"');g="admin:iq:"+g;var k={IQ:[{ATTRIBUTES:{},QUERY:[{ATTRIBUTES:{}}]}]};(sSID=l?"":dataSet.get("main",["sid"]))&&(k.IQ[0].ATTRIBUTES.SID=sSID);f&&(k.IQ[0].ATTRIBUTES.UID=f);k.IQ[0].ATTRIBUTES.TYPE="set"!=e?"get":"set";k.IQ[0].QUERY[0].ATTRIBUTES.XMLNS=g;k.IQ[0].ATTRIBUTES.FORMAT=!1===h||gui._REQUEST_VARS.xml?"application/xml":"text/json";a&&"object"==typeof a&&(k.IQ[0].QUERY[0]=arrConcat(k.IQ[0].QUERY[0],a));if(c)return request.sendArray(k,[this,"response_check",[c]],d),!0;if(a=request.sendArray(k))return a=
a.getArray(),"error"==a.IQ[0].ATTRIBUTES.TYPE&&(c=a.IQ[0].ERROR[0],this.error={},this.error.text=c.VALUE,c.ATTRIBUTES&&c.ATTRIBUTES.UID&&(this.error.id=c.ATTRIBUTES.UID,this.error.lang=getLang("ERR_"+c.ATTRIBUTES.ID))),a};a.prototype.response_check=function(a,c){try{var d=a.Array,e=d.IQ[0].ATTRIBUTES}catch(f){return!1}if("error"==e.TYPE)try{switch(d.IQ[0].QUERY[0].ERROR[0].ATTRIBUTES.UID){case "session_invalid":case "session_invalid_id":case "session_expired":case "session_no_user":try{dataSet.add("main",
["sid"],""),logout(!0)}catch(f){log.error(f)}return!1;case "session_ip_mismatch":return gui&&gui.frm_main&&gui.frm_main._acceptChangedIP&&gui.frm_main._acceptChangedIP(),!1}}catch(f){log.error(f)}else d.IQ[0].ATTRIBUTES&&d.IQ[0].ATTRIBUTES.GWSID&&(window.sPrimaryAccountGWSID=d.IQ[0].ATTRIBUTES.GWSID);try{executeCallbackFunction(c,a)}catch(f){(gui._REQUEST_VARS.debug||gui._REQUEST_VARS.frm)&&dataSet.get("main",["sid"])&&log.error(["fatal-error",f])}};a.prototype.response=function(){};a.prototype._prepareChanged=
function(a,c){var d=[];try{for(var e=0;e<a.length;e++){a[e].object&&(a[e]=a[e].object);var f=a[e]._groupChanged?"_groupChanged":"_changed";a[e][f]&&a[e][f](c)&&(log.log(["generic-_prepareChanged","CHANGED",a[e]]),d.push(a[e]))}}catch(g){log.error(["wmgeneric-preparechanged",g])}return d[0]?d:!1};a.prototype._prepareSet=function(a){for(var c=[],d=0;d<a.length;d++){var e=!1,f="val";a[d].object&&(a[d].object.__key&&(f=a[d].object.__key),a[d].val&&(f=a[d].val),a[d]=a[d].object);log.log(["objprepare",
a[d],a[d]._readonly,a[d]._readonly?a[d]._readonly():"none"]);a[d]._readonly&&a[d]._readonly()&&(e=!0);if(e)log.log("Excluded - readonly");else{e=a[d]._value();if("object"==typeof e&&null!=e){if(!e._ignore){var g=a[d].__source;g?(g.PROPERTYVAL[0]=helper.mergeDeepArray(g.PROPERTYVAL[0],e),c.push(g)):log.error(["e:prepare-save-failed-no-source",a[d]])}}else try{(g=a[d].__source)?(g.PROPERTYVAL[0][f.toUpperCase()]||(g.PROPERTYVAL[0][f.toUpperCase()]=[{}]),"tpropertynovalue"==g.PROPERTYVAL[0].CLASSNAME[0].VALUE.toLowerCase()&&
(g.PROPERTYVAL[0].CLASSNAME[0].VALUE="TPropertyString"),g.PROPERTYVAL[0][f.toUpperCase()][0].VALUE=e,c.push(g)):log.error(["e:prepare-save-failed-no-source",a[d]])}catch(h){log.error(["e:invalid-source",a[d].__source?a[d].__source:!1,h])}log.log("Prepared")}}return c};a.prototype.__attachErrorHandler=function(a,c){a||log.error(["wmgeneric-attachErrorHandler","no aHandler"]);if(a[0])return log.error(["wmgeneric-attacherrorhandler","handler cannot be array"]),a;var d=function(a){};c||"boolean"==typeof c||
(c=global.responseErrorHandler);c&&(d=function(d){try{d.Array.IQ[0].QUERY[0].ERROR?c(d.Array.IQ[0].QUERY[0].ERROR[0].ATTRIBUTES.UID):a(d)}catch(f){log.error(["wmgeneric-attachErrorHandler",f])}});return d};a.prototype.logout=function(a){a[0]||(a=[a]);this.create_iq({commandname:[{VALUE:"logout"}],commandparams:[]},[this,"__response",[a]])};a.prototype._preprocessResponse=function(a,c){c[0]||(c=[c]);return[function(d){try{if(d.Array.IQ[0].QUERY[0].ERROR&&d.Array.IQ[0].QUERY[0].ERROR[0])return c[0](!1,
d.Array.IQ[0].QUERY[0].ERROR[0].ATTRIBUTES.UID),!1}catch(e){return log.error(["generic-preprocessresponse",e]),c[0](!1,"invalid_response"),!1}c[0](a(d))}]};a.prototype._autoBooleanHandler=function(a){a[0]||(a=[a]);return[function(c){try{if(c.Array.IQ[0].QUERY[0].ERROR&&c.Array.IQ[0].QUERY[0].ERROR[0])return a[0](!1,c.Array.IQ[0].QUERY[0].ERROR[0].ATTRIBUTES.UID),!1;if(c.Array.IQ[0].QUERY[0].RESULT[0]&&0!=c.Array.IQ[0].QUERY[0].RESULT[0].VALUE)return a[0](!0,c.Array.IQ[0].QUERY[0].RESULT[0]&&c.Array.IQ[0].QUERY[0].RESULT[0]),
!0;a[0](!1);return!1}catch(d){return a[0](!1,d),!1}}]};a.prototype._autoIdHandler=function(a){a[0]||(a=[a]);return[function(c){try{if(c.Array.IQ[0].QUERY[0].ERROR&&c.Array.IQ[0].QUERY[0].ERROR[0])return a[0](!1,c.Array.IQ[0].QUERY[0].ERROR[0].ATTRIBUTES.UID),!1;if(c.Array.IQ[0].QUERY[0].RESULT[0]&&0!=c.Array.IQ[0].QUERY[0].RESULT[0].VALUE)return a[0](c.Array.IQ[0].QUERY[0].RESULT[0].VALUE),c.Array.IQ[0].QUERY[0].RESULT[0].VALUE;a[0](!1);return!1}catch(d){return a[0](!1,d),!1}}]};a.prototype._parseSingleItems=
function(a){try{var c=[],d=!1;a[0]||(d=!0,a=[a]);for(var e=0;e<a.length;e++){c[e]={};for(var f in a[e])log.info(["error",a[e][f][0]]),a[e][f][0]&&a[e][f][0].VALUE||a[e][f][0]&&"{}"==JSON.stringify(a[e][f][0])?c[e][f.toLowerCase()]=a[e][f][0].VALUE:c[e][f.toLowerCase()]=a[e][f]}}catch(g){log.error(["generic-parsesingleitems","unexpected data",g,a])}return d?c[0]:c};a.prototype.bind=function(a,c,d,e){var f=this;d||(d=COM_TYPE_SERVER);var g=[],h;for(h in c)g.push(h);e||(a._changeObserverID="changeObserver_"+
a._name,gui._changeObserver.assignListener(a._changeObserverID,function(e,g){return e?(g(),f.save(a,c,d,e),!1):f.checkChanges(a,c)}),a._add_destructor(function(){gui._changeObserver.clearListener(a._changeObserverID)},a._changeObserverID));com.console.standardized(function(d){for(var e=0;e<d.length;e++){var f=d[e],g=f.apiproperty;log.log(["general-binded",g,d]);if(c[g]){var h="",r={};"object"==typeof c[g]&&c[g][0]&&(c[g][1]&&(r=c[g][1]),r._used=!0);if("string"==typeof c[g]||r._used&&"string"==typeof c[g][0]){h=
r._used?c[g][0]:c[g];g=a[h];g.__source=f._source;g.__item=f;switch(g._type){case "obj_toggle":r.reversed&&(f._bval=!f._bval);g._checked(f._bval);break;default:g._value(f._sval)}global.setRight(a,f.propertyright,g)}else"object"==typeof c[g]&&(c[g].load&&c[g].load(f),c[g].rights&&c[g].rights(f.propertyright))}}},function(a){gui.message.error(a)})[d](g)};a.prototype._unpackxmlfile=function(a){var c={};a&&"string"==typeof a&&-1!=a.indexOf(",")&&0==a.indexOf("data:")&&(a=a.substr(5).split(","),c.content=
atob(a[1]),a=a[0].split(";"),a[0]&&(c.mime=a[0]));return c};a.prototype._downloadfile=function(a,c,d){try{var e=new Blob([a],{type:d||data[0]||"application/octet-stream"}),f=URL.createObjectURL(e),g=document.createElement("a");navigator.msSaveBlob?navigator.msSaveBlob(e,c):"download"in g?(g.href=f,g.download=c,document.body.appendChild(g),g.click(),document.body.removeChild(g)):window.location.href=f;return!0}catch(h){return log.error("ERROR: [downloadfile failed] "+c+" "+d),!1}};a.prototype.checkChanges=
function(a,c,d){var e=[],f;for(f in c)a[c[f]]?e.push(a[c[f]]):"object"==typeof c[f]?c[f].object&&a[c[f].object]?e.push(a[c[f].object]):(c[f].change&&(c[f]._changed=c[f].change),e.push(c[f])):log.error(["generic-checkchanges","object does not exist",c[f]]);a=[];for(c=0;c<e.length;c++)e[c].object&&(e[c]=e[c].object),e[c]._changed&&e[c]._changed(d)&&(log.log(["generic-_prepareChanged","CHANGED",e[c]]),a.push(e[c]));return a[0]?a:!1};a.prototype.save=function(a,c,d,e,f){log.log(["generic-save"]);var g,
h=this,l={};d||(d=COM_TYPE_SERVER);for(var k in c){var m="";g=!1;var p={};"object"==typeof c[k]&&c[k][0]&&(c[k][1]&&(p=c[k][1]),p._used=!0);if("string"==typeof c[k]||p._used&&"string"==typeof c[k][0])switch(g=p._used?c[k][0]:c[k],m=a[g],g=m._readonly(),m._type){case "obj_toggle":m=p.reversed?m._checked()?"0":"1":m._checked()?"1":"0";break;default:m=m._value()}else"object"==typeof c[k]&&(c[k].save&&(m=c[k].save()),c[k].readonly&&(g=c[k].readonly()));g||(l[k]=m)}com.console.set(function(d){h.checkChanges(a,
c,!0);if(e&&(d=e(),"undefined"!=typeof d&&0==d))return;gui.message.toast(getLang("message::save_successfull"))},function(a){if(f&&(a=f(),"undefined"!=typeof a&&0==a))return;gui.message.error(getLang("error::save_unsuccessful"))})[d](l)};a.prototype.__response=function(a,c){executeCallbackFunction(c,a)};return a}();
com=function(){function a(){}a.prototype.account=function(a){return new Account(a)};a.prototype.getProperty=function(a,c){this.getProperties([a],c)};a.prototype.getProperties=function(a,c){com.properties.get(a,c)};a.prototype.getSettings=function(a,c){com.settings.get(a,c)};return new a}();var Domain=function(a){this.type="Domain";this.id=a};Domain.prototype.getProperty=function(a,b,c){this.getProperties([a],b,c)};
Domain.prototype.getProperties=function(a,b,c){c=c||{};c.type=this.type;c.id=this.id;com.properties.get(a,b,c)};Domain.prototype.getSettings=function(a,b){com.settings.get(a,b,{type:"Domain",id:this.id})};Domain.prototype.createAccount=function(a){switch(a){case Account.GROUP:return this.createGroup();case Account.RESOURCE:return this.createResource();case Account.MAILINGLIST:return this.createMailingList();default:return this.createUser()}};
Domain.prototype.createUser=function(){return com.properties.createAccountProperties(this.id,[["u_type","TPropertyString",Account.USER],["u_mailbox","TPropertyString"],["a_name","TAccountName"],["u_password","TPropertyString"],~["saas","cloud"].indexOf(gui._globalInfo.licence.licensetype.toString())&&["u_saas_plan","TPropertyString"]].filter(Boolean))};
Domain.prototype.createGroup=function(){return com.properties.createAccountProperties(this.id,[["u_type","TPropertyString",Account.GROUP],["u_mailbox","TPropertyString"],["g_groupwarehabfolder","TPropertyString"]])};Domain.prototype.createResource=function(){return com.properties.createAccountProperties(this.id,[["u_type","TPropertyString",Account.RESOURCE],["u_mailbox","TPropertyString"],["u_name","TPropertyString"],["s_type","TPropertyString"]])};
Domain.prototype.createMailingList=function(){return com.properties.createAccountProperties(this.id,[["u_type","TPropertyString",Account.MAILINGLIST],["u_mailbox","TPropertyString"],["m_sendalllists","TPropertyString","0"]])};Domain.prototype.getAccountList=function(a){var b=com.list.fetch("Accounts",{domainstr:this.id});a.type&&b.type(a.type);return b};Domain.prototype.getUserList=function(){return this.getAccountList({type:Account.USER})};Domain.prototype.getGroupList=function(){return this.getAccountList({type:Account.GROUP})};
Domain.prototype.getMailingList=function(){return this.getAccountList({type:Account.MAILINGLIST})};Domain.prototype.getResourceList=function(){return this.getAccountList({type:Account.RESOURCE})};var Account=function(a){this.type="Account";this.id=a};Account.USER="0";Account.GROUP="7";Account.RESOURCE="8";Account.MAILINGLIST="1";Account.prototype.getProperty=function(a,b,c){this.getProperties([a],b,c)};
Account.prototype.getProperties=function(a,b,c){c=c||{};c.type=this.type;c.id=this.id;com.properties.get(a,b,c)};Account.prototype.getPropertySet=function(a,b,c){c=c||{};c.type=this.type;c.id=this.id;c.set=1;com.properties.get(a,b,c)};Account.prototype.getMemberList=function(){return com.members.getList(this.id)};
function cInit(a){a=a||{};document.getElementsByTagName("body")[0].innerHTML="";window.sSessionUID=unique_id();window.request=new cRequest("/icewarpapi/");window.gui=new cObject("gui");storage.library("ts_helpers");storage.library("constants_ext");storage.library("global_ext");storage.library("wm_generic");storage.library("obj_generic");storage.library("helpers_ext");storage.library("punycode_ext");storage.library("chartist.min");storage.library("dataset");var b=location.href.split("#")[0].split("?"),
b=b[1]?helper.parse_query(b[1]):{};storage.library("class_errorhandler");var c={verbosity:LOGGER_ERROR};b.frm&&(c={verbosity:LOGGER_ALL});b.alert&&(c.type=LOGGER_ALERT);window.log=new logger(c);gui._setTitle=function(a){document.title=helper.htmlspecialchars(a)};0<=location.search.search("proxy")&&(window.request=new cRequest("./server/proxy.php?com"));a.sid?(dataSet.add("main",["sid"],a.sid),Cookies.set("waid",a.sid,{expires:1,path:"/admin/"})):Cookies.get("waid")&&""==Cookies.get("waid")?(Cookies.remove("waid",
{path:"/admin"}),Cookies.remove("waid",{path:"/admin/"}),location.reload()):dataSet.add("main",["sid"],Cookies.get("waid"));gui._REQUEST_VARS=b;Cookies.get("wall")&&""!=Cookies.get("wall")?storage.language(Cookies.get("wall")):storage.language("en");gui._setTitle(getLang("generic::icewarp_webadmin"));b.frm&&"full"==b.frm||storage.css("style");b.frm||(storage.library("javascript"),storage.template("templates"),storage.preloadObj());storage.library("wm_general");storage.library("wm_domain");storage.library("wm_server");
storage.library("wm_resources");storage.library("wm_licence");storage.library("wm_user");gui._create("connection","obj_connection");window.oWM_INIT=this;gui._globalInfo={domainRightsRaw:[],serverRightsRaw:[],getDomainRights:function(a){for(var b=gui._globalInfo.domainRightsRaw,c=0;c<b.length;c++)try{if(b[c].APIPROPERTY[0].PROPNAME[0].VALUE.toLowerCase()==a.toLowerCase())return"0"!=b[c].PROPERTYRIGHT[0].VALUE.toString()&&"3"!=b[c].PROPERTYRIGHT[0].VALUE.toString()?!0:!1}catch(g){}return!1},getServerRights:function(a){for(var b=
gui._globalInfo.serverRightsRaw,c=0;c<b.length;c++)try{if(b[c].APIPROPERTY[0].PROPNAME[0].VALUE.toLowerCase()==a.toLowerCase())return"0"!=b[c].PROPERTYRIGHT[0].VALUE.toString()&&"3"!=b[c].PROPERTYRIGHT[0].VALUE.toString()?!0:!1}catch(g){}return!1},css:{backgrounds:helper.loadCSSManagedSettings("css-backgrounds"),settings:helper.loadCSSManagedSettings("css-settings"),colors:helper.loadCSSManagedSettings("css-colors")},_update:function(a){log.info("sherlock-sktnvus-#0");com.general.sessionInfo(function(b){if(b.Array.IQ[0].QUERY[0].RESULT&&
b.Array.IQ[0].QUERY[0].RESULT[0].DOMAIN&&b.Array.IQ[0].QUERY[0].RESULT[0].DOMAIN[0].VALUE&&b.Array.IQ[0].QUERY[0].RESULT[0].EMAIL&&b.Array.IQ[0].QUERY[0].RESULT[0].EMAIL[0].VALUE&&b.Array.IQ[0].QUERY[0].RESULT[0].ADMINTYPE&&b.Array.IQ[0].QUERY[0].RESULT[0].ADMINTYPE[0].VALUE){try{for(var c in b.Array.IQ[0].QUERY[0].RESULT[0])b.Array.IQ[0].QUERY[0].RESULT[0][c][0]&&b.Array.IQ[0].QUERY[0].RESULT[0][c][0].VALUE&&(gui._globalInfo[c.toLowerCase()]=b.Array.IQ[0].QUERY[0].RESULT[0][c][0].VALUE);var g=b.Array.IQ[0].QUERY[0].RESULT[0].NAME;
gui._globalInfo.fullname=g?(g[0].NAME[0].VALUE?g[0].NAME[0].VALUE+" ":"")+(g[0].SURNAME[0].VALUE?g[0].SURNAME[0].VALUE:""):"";b.Array.IQ[0].QUERY[0].RESULT[0].IMAGE&&(gui._globalInfo.userimage="data:"+b.Array.IQ[0].QUERY[0].RESULT[0].IMAGE[0].CONTENTTYPE[0].VALUE+";base64,"+b.Array.IQ[0].QUERY[0].RESULT[0].IMAGE[0].BASE64DATA[0].VALUE)}catch(h){log.error(["init-sessioninfo",h])}gui._activeDomain=gui._globalInfo.domain;Cookies.get("wala")&&Cookies.get("wala")!=gui._globalInfo.email&&(location.hash=
"");Cookies.set("wala",gui._globalInfo.email,{expires:1,path:"/admin/"});com.domain.rights(gui._globalInfo.domain,"V_CreateUser V_CreateMailingList V_CreateGroup V_CreateResource V_DeleteUser V_DeleteMailingList V_DeleteGroup V_DeleteResource V_CreateDomain".split(" "),function(b){b.Array.IQ[0].QUERY[0].RESULT&&b.Array.IQ[0].QUERY[0].RESULT[0].ITEM&&b.Array.IQ[0].QUERY[0].RESULT[0].ITEM[0]?(log.log(b.Array.IQ[0].QUERY[0].RESULT[0].ITEM),gui._globalInfo.domainRightsRaw=b.Array.IQ[0].QUERY[0].RESULT[0].ITEM,
com.server.rights(["V_SpamQueues"],function(b){if(b.Array.IQ[0].QUERY[0].RESULT&&b.Array.IQ[0].QUERY[0].RESULT[0].ITEM&&b.Array.IQ[0].QUERY[0].RESULT[0].ITEM[0]){log.log(b.Array.IQ[0].QUERY[0].RESULT[0].ITEM);gui._globalInfo.serverRightsRaw=b.Array.IQ[0].QUERY[0].RESULT[0].ITEM;gui._globalInfo.licence={};gui._globalInfo.resources={};gui._globalInfo.accountProperties={};if(+gui._globalInfo.isgateway)return a();(new Domain(gui._globalInfo.domain)).getSettings(["layout_settings_admin","restrictions"],
function(b){gui._globalInfo.resources=b;com.licence.get(function(b){try{gui._globalInfo.licence=b,com.user.info(gui._globalInfo.email,function(b){b=b.Array.IQ[0].QUERY[0].RESULT[0].ITEM;for(var c=0;c<b.length;c++)b[c].PROPERTYVAL[0].VAL&&(gui._globalInfo.accountProperties[b[c].APIPROPERTY[0].PROPNAME[0].VALUE.toLowerCase()]=b[c].PROPERTYVAL[0].VAL[0].VALUE);try{a()}catch(e){log.error(["init-resourceshandler-callback",e]),alert(getLang("error::fatal_communication_error #6"))}})}catch(c){log.error(["init-resourceshandler-webadmin",
c]),alert(getLang("error::fatal_communication_error #5"))}})})}else alert(getLang("error::fatal_communication_error #3"))})):alert(getLang("error::fatal_communication_error #2"))})}else alert(getLang("error::fatal_communication_error #1"))})}};gui._globalInfo._update(function(){gui._create("frm_main","frm_main")});gui._changeObserver={};gui._changeObserver.listeners={};gui._changeObserver.assignListener=function(a,b){gui._changeObserver.listeners[a]=b};gui._changeObserver.clearListener=function(a){delete gui._changeObserver.listeners[a]};
gui._changeObserver.assignTrigger=function(a){log.log(["init-changeobserver","Assigning observer",a]);var b=a._onclick?"_onclick":"onclick",c=a[b];a._CO_oc=c;a._CO_f=b;a[b]=function(a){var b=!1,d;for(d in gui._changeObserver.listeners)try{gui._changeObserver.listeners[d]()&&(b=!0)}catch(e){gui._changeObserver.clearListener(d)}b?gui.message.warning(getLang("warning::changes_found"),!1,[{value:getLang("generic::cancel"),type:"text borderless",method:"close"},{value:getLang("generic::do_not_save"),type:"text error",
onclick:function(b){b();c(a)}},{value:getLang("generic::save"),type:"success text",onclick:function(b){for(var d in gui._changeObserver.listeners)try{gui._changeObserver.listeners[d](function(){b();c(a)},b)}catch(e){gui._changeObserver.clearListener(d)}}}]):c(a)};return!1};gui._changeObserver.clearTrigger=function(a){a[a._CO_f]=a._CO_oc}}
function logout(a,b){function c(a){["","/","/admin","/admin/",location.pathname,location.pathname+"/"].forEach(function(b){Cookies.remove(a,{path:b})})}var d=function(){log.info("go logout");c("waid");c("wala");var a=Cookies.get("ware");a?(c("ware"),b?b(a):location.href=a):b?b():location.reload();log.info("should logout")};if(a)return d(),!0;com.server.logout(d)}function initPRO(a){new cInit(a)}function gw_others(){}var _me=gw_others.prototype;
_me.load=function(a,b,c){storage.library("wm_storage");b=b||"storage";dataSet.add(b,c,WMStorage.get({resources:a}),!0);this.checkLayoutSettings(b,c)};
_me.get=function(a,b,c,d){if(!a||!b)return!1;var e=dataSet.get(b,[a]),f=!1;d&&"object"!=typeof e&&(storage.library("wm_storage"),d=WMStorage.get({resources:[a]}),d[a]&&"object"==typeof d[a]&&!Is.Empty(d[a].ITEMS)&&(e=d[a],dataSet.add(b,[a],e,!0)));if("object"!=typeof e||Is.Empty(e.ITEMS))e={ITEMS:[{VALUES:{},ATTRIBUTES:{DONT_SEND:!0}}],ATTRIBUTES:{DONT_SEND:!0}},f=!0;if(!(e=this.setDefault(a,e,b,f)))return!1;a={full:0,view:1,none:2};b=e.ATTRIBUTES.ACCESS?e.ATTRIBUTES.ACCESS:"full";if(c)var g=e.ATTRIBUTES.USERACCESS?
e.ATTRIBUTES.USERACCESS:"full",h=e.ATTRIBUTES.DOMAINADMINACCESS?e.ATTRIBUTES.DOMAINADMINACCESS:"full";d=e.ITEMS[0];e=d.ATTRIBUTES.ACCESS?d.ATTRIBUTES.ACCESS:"full";b=a[b]>=a[e]?b:e;c&&(e=d.ATTRIBUTES.USERACCESS?d.ATTRIBUTES.USERACCESS:"full",f=d.ATTRIBUTES.DOMAINADMINACCESS?d.ATTRIBUTES.DOMAINADMINACCESS:"full",g=a[g]>=a[e]?g:e,h=a[h]>=a[f]?h:f);d=d.VALUES;var l={VALUES:{},ACCESS:{}},k=l.VALUES,m=l.ACCESS;if(c)var p=l.USERACCESS=[],q=l.DOMAINADMINACCESS=[];var r,v;for(v in d)r=v.toLowerCase(),k[r]=
d[v].VALUE,e=d[v].ATTRIBUTES.ACCESS?d[v].ATTRIBUTES.ACCESS:"full",m[r]=a[b]>=a[e]?b:e,c&&(e=d[v].ATTRIBUTES.USERACCESS?d[v].ATTRIBUTES.USERACCESS:"full",p[r]=a[g]>=a[e]?g:e,f=d[v].ATTRIBUTES.DOMAINADMINACCESS?d[v].ATTRIBUTES.DOMAINADMINACCESS:"full",q[r]=a[h]>=a[f]?h:f);return l};
_me.set=function(a,b,c,d){if(!a||"object"!=typeof b||!c)return!1;var e=dataSet.get(c,[a]);if("object"!=typeof e||Is.Empty(e.ITEMS)){e={ITEMS:[{VALUES:{},ATTRIBUTES:{DONT_SEND:!1}}],ATTRIBUTES:{DONT_SEND:!1}};g=e.ITEMS[0].VALUES;for(m in b)g[m.toUpperCase()]={VALUE:b[m],ATTRIBUTES:{}};dataSet.add(c,[a],e,!0)}else{var f=e.ITEMS[0],g=f.VALUES,h=!1,l=!1,k,m;for(m in b){l=!1;k=m.toUpperCase();"object"!=typeof g[k]&&(g[k]={ATTRIBUTES:{}});g[k].VALUE!=b[m]&&(g[k].VALUE=b[m],l=!0);if(d){if(d.USERACCESS){var p=
d.USERACCESS[m]?d.USERACCESS[m]:"full";(g[k].ATTRIBUTES.USERACCESS?g[k].ATTRIBUTES.USERACCESS:"full")!=p&&(g[k].ATTRIBUTES.USERACCESS=p,l=!0)}d.DOMAINADMINACCESS&&(p=d.DOMAINADMINACCESS[m]?d.DOMAINADMINACCESS[m]:"full",(g[k].ATTRIBUTES.DOMAINADMINACCESS?g[k].ATTRIBUTES.DOMAINADMINACCESS:"full")!=p&&(g[k].ATTRIBUTES.DOMAINADMINACCESS=p,l=!0))}l&&(h=!0,g[k].ATTRIBUTES.DEFAULT=!1)}h&&(e.ATTRIBUTES.DONT_SEND=!1,f.ATTRIBUTES.DONT_SEND=!1,dataSet.add(c,[a],e,!0))}return!0};
_me.getItem=function(a,b,c){b=b.toUpperCase();var d=dataSet.get(c||"storage",[a,"ITEMS",0,"VALUES",b]);d||(GWOthers.get(a,c||"storage"),d=dataSet.get(c||"storage",[a,"ITEMS",0,"VALUES",b]));if(d)return d.VALUE};_me.getItemAccess=function(a,b){b=b.toUpperCase();var c=dataSet.get("storage",[a,"ITEMS",0,"VALUES",b]);c||(GWOthers.get(a,"storage"),c=dataSet.get("storage",[a,"ITEMS",0,"VALUES",b]));return c?!c.ATTRIBUTES||"view"!=c.ATTRIBUTES.ACCESS:!1};
_me.setItem=function(a,b,c){var d={};d[b]=c;GWOthers.set(a,d,"storage")};_me.save=function(a){WMStorage.set({resources:dataSet.get("storage")},"storage","",a)};_me.setDefault=function(a,b,c,d){var e=this.getDefaultValues(a);if("object"==typeof e){d=b.ITEMS[0].VALUES;var f=!1,g;for(g in e)"undefined"==typeof d[g]&&(d[g]={VALUE:e[g],ATTRIBUTES:{DEFAULT:!0}},f=!0);f&&dataSet.add(c,[a],b,!0);return b}return d?!1:b};
_me.getDefaultValues=function(a){var b;switch(a){case "GLOBAL_SETTINGS":b={HTTP_PORT:sPrimaryAccountHTTP};break;case "SKINS":b={DEFAULT:"Default"};break;case "IM":b={ENTER_SEND:1,AUTO_CHAT:1,AUTO_STATUS:1,SMILES:1,STATUS_DND:1};break;case "MAIL_SETTINGS_DEFAULT":b={REPLY_MYSELF:0,CHECK_SUBJECT:1,SIGN_TOP:1,FONT_FAMILY:0,FONT_SIZE:0,TEXT_DIRECTION:"LTR",SPELLCHECKER:"en",HTML_MESSAGE:0,REPLY_MESSAGE:0,READ_CONFIRMATION:0,SAVE_SENT_MESSAGE:1,ENCRYPT:0,SIGN:0,REPLY_TO_ADDRESS:"",PRIORITY:3,CHARSET:"UTF-8"};
break;case "MAIL_SETTINGS_GENERAL":b={SOUND_NOTIFY:0,AUTOUPDATE:1,AUTOUPDATE_MINUTES:5,MOVE_TO_TRASH:1,FORWARD_MESSAGES:"inline",AUTOSAVE:1,AUTOSAVE_MINUTES:5,DEFAULT_FLAG:"1",AUTO_RECIPIENT_TO_ADDRESSBOOK:"0",AUTO_SHOW_IMAGES:"0",AUTOCLEAR_TRASH_DAYS:"30"};break;case "LAYOUT_SETTINGS":b={INTERFACES:"abp",ACTIVITY:0,SSL_SWFATT:0,LOGIN_STYLE:"blue",LOGIN_CLIENT:"advanced",SKIN:"default",SKIN_STYLE:"default",LANGUAGE:"en",DISABLE_SWFUPLOAD:0,DISABLE_OFFICE:0,LOGIN_LOGO:"login_logo.png",DATE_FORMAT:0,
TIME_FORMAT:0,INIT_PAGE:"i",CONFIRM_EXIT:1,NOTIFICATIONS:0,BANNER_ENABLED:1};break;case "HOMEPAGE_SETTINGS":b={BANNER_HEIGHT:60,APPLICATION:1};break;case "CALENDAR_SETTINGS":b={WEEK_BEGINS:"sunday",BEGIN_ON_TODAY:0,DAY_BEGINS:8,DAY_ENDS:16,TEMPERATURE:"C",AUTOCLEAR_TRASH_DAYS:"30"};break;case "DEFAULT_CALENDAR_SETTINGS":b={EVENT_VIEW:"week_view",EVENT_SHOW_AS:"S",EVENT_SHARING:"U",CONTACT_SHARING:"U",JOURNAL_SHARING:"U",NOTE_SHARING:"U",FILE_SHARING:"U",TASK_SHARING:"U"};break;case "EVENT_SETTINGS":b=
{TIME:0,RM_TYPE:"E",EMAIL:""};break;case "DEFAULT_FOLDERS":b={SENT:sPrimaryAccount+"/"+getLang("COMMON_FOLDERS::SENT"),TRASH:sPrimaryAccount+"/"+getLang("COMMON_FOLDERS::TRASH"),DRAFTS:sPrimaryAccount+"/"+getLang("COMMON_FOLDERS::DRAFTS"),CONTACTS:sPrimaryAccount+"/"+getLang("FOLDERS::CONTACTS"),EVENTS:sPrimaryAccount+"/"+getLang("FOLDERS::EVENTS"),TASKS:sPrimaryAccount+"/"+getLang("FOLDERS::TASKS"),NOTES:sPrimaryAccount+"/"+getLang("FOLDERS::NOTES"),JOURNAL:sPrimaryAccount+"/"+getLang("FOLDERS::JOURNAL"),
FILES:sPrimaryAccount+"/"+getLang("FOLDERS::FILES"),SMART:sPrimaryAccount+"/"+getLang("FOLDERS::FILES")};break;case "READ_CONFIRMATION":b={TEXT:getLang("EMAIL::READING_CONFIRMATION"),SUBJECT:getLang("EMAIL::READING_CONFIRMATION_SUBJECT"),SEND_CONFIRMATION:0};break;case "SIGNATURE":b={TEXT:"",ENABLE:1};break;case "LOGIN_DATA":b={IE_6_WARNING_SHOW_ON:0};break;case "RESET_SETTINGS":b={ENABLED:0,MAIL:getLang("RESET_PASS::EMAIL"),SUBJECT:getLang("RESET_PASS::SUBJECT")};break;case "RESTRICTIONS":b={SORTSTRING:0,
DISABLE_OTHERACCOUNTS:0,DISABLE_CHANGEPASS:0,DISABLE_SIGNUP:1,DISABLE_DROPBOX:0,GAL_SUGGEST:1};break;case "SIP":b={MODE:"integrate"}}return b};
_me.checkLayoutSettings=function(a,b){var c=this.get("SKINS",a,b);if(c){var d={},e;for(e in c.VALUES)"value"!=e&&(d[e]=c.VALUES[e]);d[this.getItem("LAYOUT_SETTINGS","skin")]||this.setItem("LAYOUT_SETTINGS","skin",this.getDefaultValues("LAYOUT_SETTINGS").SKIN)}if(c=this.get("LANGUAGES",a,b)){d={};for(e in c.VALUES)d[e]=c.VALUES[e];d[this.getItem("LAYOUT_SETTINGS","language")]||this.setItem("LAYOUT_SETTINGS","language",this.getDefaultValues("LAYOUT_SETTINGS").LANGUAGE)}};var GWOthers=new gw_others;
this.JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,r,v,w=f,u,t=d[a];t&&"object"===typeof t&&"function"===typeof t.toJSON&&(t=t.toJSON(a));"function"===typeof l&&(t=l.call(d,a,t));switch(typeof t){case "string":return b(t);case "number":return isFinite(t)?String(t):"null";case "boolean":case "null":return String(t);case "object":if(!t)return"null";
f+=g;u=[];if("[object Array]"===Object.prototype.toString.apply(t)){v=t.length;for(e=0;e<v;e+=1)u[e]=c(e,t)||"null";r=0===u.length?"[]":f?"[\n"+f+u.join(",\n"+f)+"\n"+w+"]":"["+u.join(",")+"]";f=w;return r}if(l&&"object"===typeof l)for(v=l.length,e=0;e<v;e+=1)h=l[e],"string"===typeof h&&(r=c(h,t))&&u.push(b(h)+(f?": ":":")+r);else for(h in t)Object.hasOwnProperty.call(t,h)&&(r=c(h,t))&&u.push(b(h)+(f?": ":":")+r);r=0===u.length?"{}":f?"{\n"+f+u.join(",\n"+f)+"\n"+w+"}":"{"+u.join(",")+"}";f=w;return r}}
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;g=f="";if("number"===typeof d)for(e=0;e<d;e+=1)g+=" ";else"string"===typeof d&&(g=d);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.hasOwnProperty.call(g,
e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var e;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();_me=obj_popup.prototype;
function obj_popup(){}var that=!1;
_me.__constructor=function(a){var b=this;that=b;if(gui._popupList)for(a=0;a<gui._popupList.length;a++)gui._popupList[a]._hide();else gui._popupList=[];gui._popupList.push(this);log.log(this.main._setHeadingButton);this.main._setHeadingButton("",function(){b._refresh=null;b.content&&b.content._data&&b.content._data.hasChanged&&b.content._data.hasChanged()?b._unsavedChangesFound():b._close()},"button obj_button icon icon-close _noduplicate");this._fixed(!0);this._main.onclick=function(){var a=a||window.event;
if("modal"==(a.target||a.srcElement).className)return b._refresh=null,b._close(),a.cancelBubble=!0,a.stopPropagation(),!1};addcss(document.getElementsByTagName("body")[0],"has-modal");this._add_destructor("__onbeforedestruct")};_me.__onbeforedestruct=function(){this._onbeforedestruct&&this._onbeforedestruct(this);this.content&&this.content._destruct();0==gui._popupList.length&&removecss(document.getElementsByTagName("body")[0],"has-modal");this._refresh&&this._refresh()};_me._save=!1;
_me._init=function(a,b){var c=this;c._type("modal");c._iwAttr("name",a.name);"default"==a.footer&&(a.footer="obj_popup_footer");a.onsave&&(c._save=a.onsave,delete a.onsave);a.refresh&&(c._refresh=a.refresh,delete a.refresh);"undefined"!=typeof a.fixed&&(c._fixed(a.fixed),delete a.fixed);"undefined"!=typeof a.size&&(c._size(a.size),delete a.size);"undefined"!=typeof a.classes&&(c._addClass(a.classes),delete a.classes);"undefined"!=typeof a.type&&"default"!=a.type&&(c._type(a.type),delete a.type);"undefined"!=
typeof a.iwattr&&(c._iwAttr(a.iwattr),delete a.iwattr);this.main._init(a,function(){c.main.btn_save&&(c.main.btn_save._onclick=function(){c._save?c._save():c.content._save&&c.content._save()});c.main.btn_cancel&&(c.main.btn_cancel._onclick=function(a){c._refresh=null;c.content&&c.content._data&&c.content._data.hasChanged&&c.content._data.hasChanged()?c._unsavedChangesFound():c._close()});a.content&&(c.main[a.name]||(c.main._clean("main_content"),c.main._create(a.name,a.content,"main_content")),c.content=
c.main[a.name],c.content._close=function(){c._close()},c.content._saveFeedbackAndClose=function(a){c._saveFeedbackAndClose(a)},c.content._fillFieldsWithData=function(a){c._fillFieldsWithData(a)});a.template&&(c.main._clean("main_content"),c.main._draw(a.template,"main_content"));b&&b()})};_me._hide=function(){log.log("should be hidden");this._main.setAttribute("is-hidden",1)};_me._show=function(){this._main.removeAttribute("is-hidden")};
_me._overlay=function(){var a=this;return{_iwAttr:function(b,c){a._iwAttr(b,c,a._getAnchor("overlay"))}}};_me._iwAttr=function(a,b,c){c||(c=this.main._main);"object"!=typeof a&&(n={},n[a]=b,a=n);for(var d in a)c.setAttribute("iw-"+d,a[d])};_me._type=function(a){this.main._iwAttr("type",a)};_me._fixed=function(a){this.main._isFixed(a)};_me._size=function(a){this.main._size(a)};_me._addClass=function(a){this.main._addClass(a)};_me._removeClass=function(a){this.main._removeClass(a)};
_me._close=function(){if(gui._popupList){for(var a=0,b=0;b<gui._popupList.length;b++)gui._popupList[b]==this&&(a=b);gui._popupList.splice(a,1)}else gui._popupList=[];this._destruct();0<gui._popupList.length&&gui._popupList[gui._popupList.length-1]._show()};
_me._fillFieldsWithData=function(a){var b=window[this.content._type]._mapping;a=a||this.content._data;if(b&&a){this.content._mapping={};for(var c in b)if(a[b[c]])this.content._mapping[c]=a[b[c]];else{var d=new IWAPI.Value(null,b[c]);this.content._mapping[c]=d;a.addItem(d)}for(c in this.content._mapping)this.content[c]?this.content[c]._setValue(this.content._mapping[c]):this.content._parent[c]&&this.content._parent[c]._setValue(this.content._mapping[c])}};
_me._saveFeedbackAndClose=function(a){a?(gui.message.toast(getLang("message::save_successfull")),this._close()):gui.message.error(getLang("error::save_unsuccessful"))};
_me._unsavedChangesFound=function(){var a=this;gui.message.warning(getLang("warning::changes_found"),!1,[{value:getLang("generic::cancel"),type:"text borderless",method:"close"},{value:getLang("generic::do_not_save"),type:"text error",onclick:function(b){b();a._close()}},{value:getLang("generic::save"),type:"success text",onclick:function(b){b();a.content&&a.content._save&&a.content._save()}}])};var PopupWindowView=function(a){this._control=a};
PopupWindowView.prototype.saveNotification=function(a){a?(gui.message.toast(getLang("message::save_successfull")),this._control._close()):gui.message.error(getLang("error::save_unsuccessful"))};_me=obj_form_generic.prototype;function obj_form_generic(){}_me._class=function(a){this._elmbox&&addcss(this._elmbox,a)};
_me._value=function(a){if("undefined"!=typeof a)this.__eIN.value=a,this.__restrictions&&this.__restrictions.length&&this.__check();else return this.__eIN.value.replace(/(\r\n)/gm,"\n").replace(/\n/gm,"\r\n")};
_me._setValue=function(a){var b=this;void 0==a.value&&a["default"]?this._value(a["default"]):this._value(a.value);a.readonly&&this._readonly(!0);if(a.denied){this._main.setAttribute("is-hidden","1");var c=this._main.id.match(/\.input([a-z_]+)$/);if(c){var c="fi"+c[1],d=this._main.parentNode.parentNode;d.id.indexOf(c)==d.id.length-c.length&&(d=d.getElementsByTagName("label"),d.length&&(d[0].style.display="none"))}}void 0==this.__apivalue&&this.__eIN.addEventListener("change",function(){b.__apivalue.value=
this.value},!1);this.__apivalue=a};_me._getValue=function(){return this.__apivalue};_me._readonly=function(){this.__readonly=!0;this._disabled(!0)};_me._disabled=function(a){if("undefined"==typeof a)return this.__eIN.disabled;a?(this.__eIN.disabled=!0,addcss(this._main,"disabled")):this.__readonly||(this.__eIN.disabled=!1,removecss(this._main,"disabled"))};_me._getFocusElement=function(){return this.__eIN};
_me._focus=function(){if(navigator.os&&"iOS"==navigator.os.name)return!0;var a=this._getFocusElement();return a.offsetParent&&"BODY"!=a.offsetParent.tagName?(a.focus(),!0):!1};_me.__update=function(a){if(!this._listener)this._listener=a;else if(a&&this._listener!=a)return;this._value(dataSet.get(this._listener,this._listenerPath))};_me._triggerLocalObey=function(a,b){if(this.__obeyLocalList&&this.__obeyLocalList[a])for(var c in this.__obeyLocalList[a])this.__obeyLocalList[a][c].apply(this,b)};
_me._obeyLocal=function(a,b,c){c||(c=helper.uniqid());this.__obeyLocalList=this.__obeyLocalList||{};this.__obeyLocalList[a]=this.__obeyLocalList[a]||{};this.__obeyLocalList[a][c]=b};_me._disobeyLocal=function(a,b){b||(b=helper.uniqid());this.__obeyLocalList=this.__obeyLocalList||{};this.__obeyLocalList[a]=this.__obeyLocalList[a]||{};this.__obeyLocalList[a][b]&&delete this.__obeyLocalList[a][b]};_me=obj_form_tab.prototype;function obj_form_tab(){}
_me.__constructor=function(){var a=this,b;this._getFocusElement&&(b=this._getFocusElement())&&("Opera"==currentBrowser()?(AttachEvent(b,"onkeydown",function(a){this.lastKey=a.keyCode;this.lastShift=a.shiftKey}),AttachEvent(b,"onblur",function(b){9==this.lastKey&&a.__tabIndex_dock&&(this.lastShift?a.__tabIndex_dock._tabIndexPrev(a):a.__tabIndex_dock._tabIndexNext(a));this.hasFocus=!1;a.__tabIndex_dock&&(a.__tabIndex_dock.__lastFocus=a._pathName);this.lastShift=this.lastKey=null}),AttachEvent(b,"onfocus",
function(b){this.hasFocus=!0;a.__tabIndex_dock&&(a.__tabIndex_dock.__lastFocus=a._pathName);this.lastShift=this.lastKey=null})):(AttachEvent(b,"onkeydown",function(b){b=b||window.event;if(9==b.keyCode){b.cancelBubble=!0;try{b.preventDefault()}catch(d){}try{b.stopPropagation()}catch(d){}!b.ctrlKey&&a.__tabIndex_dock&&(b.shiftKey?a.__tabIndex_dock._tabIndexPrev(a):a.__tabIndex_dock._tabIndexNext(a));return!1}}),AttachEvent(b,"onblur",function(b){this.hasFocus=!1;a.__tabIndex_dock&&(a.__tabIndex_dock.__lastFocus=
"")}),AttachEvent(b,"onfocus",function(b){this.hasFocus=!0;a.__tabIndex_dock&&(a.__tabIndex_dock.__lastFocus=a._pathName)})),this._add_destructor("__disobeyTabIndex"))};_me._tabIndex=function(a,b,c){if(!c)for(var d=this;d=d._parent;)if(d.__addTabIndex){c=d;break}c&&(this.__disobeyTabIndex(),c.__addTabIndex(this,a,b)&&(this.__tabIndex_dock=c))};_me._hasFocus=function(){return this._getFocusElement().hasFocus};
_me.__disobeyTabIndex=function(){this.__tabIndex_dock&&(this.__tabIndex_dock.__removeTabIndex(this),this.__tabIndex_dock=null)};_me=obj_button.prototype;function obj_button(){}
_me.__constructor=function(){var a=mkElement("input",{type:"button",name:this._pathName+"#main",id:this._pathName+"#main"});this._main.appendChild(a);a.className="obj_button"==this._type?"obj_button":"obj_button "+this._type;this.__eIN=a.form[a.name];this._elm=a;var b=this;this.__attributes.title&&this._title(this.__attributes.title);this.__eIN.onclick=this._main.onclick=function(a){a=a||window.event;var d=a.target||a.srcElement;b._disabled()||(d==b._main&&b._focus(),b._onclick&&b._onclick(a));a.stopPropagation();
a.cancelBubble=!0;return!1};this.__eIN.onfocus=function(a){a=a||window.event;b.__hasFocus=!0;b._onfocus&&b._onfocus(a);b.__exeEvent("onfocus",a,{owner:b});addcss(b._main,"focus");return!0};this.__eIN.onblur=function(a){a=a||window.event;b.__hasFocus=!1;if(b._onblur&&!1===b._onblur(a))return!1;b.__exeEvent("onblur",a,{owner:b});removecss(b._main,"focus");return!0};this._main.oncontextmenu=function(a){a=a||window.event;b._oncontext&&!1!==b._oncontext(a)&&b.__exeEvent("oncontext",a,{owner:b})};this._main.onkeydown=
function(a){a=a||window.event;!b._disabled()&&b._onkeypress&&b._onkeypress(a);return!0}};
_me._disabled=function(a){a&&"object"==typeof a&&(this._disablealso_ids=a);if(this._disablealso_ids)for(var b=this._disablealso_ids,c=0;c<b.length;c++)this._parent[b[c]]?this._parent[b[c]]._disabled&&this._parent[b[c]]._disabled(!0):this._parent._getAnchor(b[c])&&(a?addcss(this._parent._getAnchor(b[c]),"is-disabled"):removecss(this._parent._getAnchor(b[c]),"is-disabled"));a?addcss(this._main,"is-disabled"):removecss(this._main,"is-disabled");return this._elm.disabled=a};
_me._addcss=function(a){addcss(this._main,a)};_me._removecss=function(a){removecss(this._main,a)};_me._value=function(a){""==a&&(this.__eIN.value=a);return this.__eIN.value=a?getLang(a):this.__eIN.value};_me._text=function(a){if(Is.String(a))this.__eIN.value=a;else return this.__eIN.value||""};_me._title=function(a){if(Is.String(a))this.__eIN.title=-1!=a.indexOf("::")?getLang(a):a;else return this.__eIN.title||""};
_me._hide=function(a){"undefined"==typeof a&&(a=!0);a?addcss(this._main,"hide"):removecss(this._main,"hide")};_me._show=function(){removecss(this._main,"hide")};_me._readonly=function(){};_me._iwAttr=function(a,b){"object"!=typeof a&&(n={},n[a]=b,a=n);for(var c in a)this._main.setAttribute("iw-"+c,a[c])};_me=obj_connection.prototype;function obj_connection(){}
_me.__constructor=function(){var a=this;this.__requests=[];this.__count=null;this.__dimmer=mkElement("div",{id:"dimmer"});document.body.appendChild(this.__dimmer);this.btn_ok._onclick=function(){a.__requests.shift();a._show()};this.btn_re._onclick=function(){a._flush()};this.btn_cancel._onclick=function(){a._clear()};this._add_destructor("__destructor")};
_me._queue=function(a,b,c,d){this.__requests.push({code:a,delay:b||0,handler:c,errorHandler:d});cRequest&&(30<cRequest.lapse||1>cRequest.lapse)||1==this.__requests.length&&this._show()};_me._flush=function(){for(var a,b=0,c=this.__requests.length;b<c;b++)(a=this.__requests.shift())&&a.handler&&executeCallbackFunction(a.handler);this._show()};
_me._clear=function(){for(var a,b=0,c=this.__requests.length;b<c;b++)(a=this.__requests.shift())&&a.errorHandler&&executeCallbackFunction(a.errorHandler,!1);this._show()};
_me._show=function(){"undefined"!=typeof this.__titleID&&gui.frm_main&&gui.frm_main.title&&gui.frm_main.title._remove(this.__titleID,!0);var a=this.__requests[0];if(a){"undefined"!=typeof this.__interval&&window.clearInterval(this.__interval);0<a.delay?(this.__count=a.delay,this._getAnchor("countdown").innerHTML=getLang("ERROR::COUNTDOWN",[a.delay]),this.__interval=window.setInterval("try{"+this._pathName+"._refresh()}catch(r){}",1E3)):this.__count=0;this._main.style.display="block";this._getAnchor("retry").style.display=
"none";this._getAnchor("countdown").style.display="none";this._getAnchor("accept").style.display="none";this._getAnchor("cancel").style.display=a.delay?"block":"none";var b;switch(a.code){case 404:this.__dimmer.style.display="block";b="ERROR::FILENOTFOUND";a.delay=0;break;case 500:b="ERROR::SERVERERROR";a.delay=0;break;case 503:this.__dimmer.style.display="block";b="ERROR::OVERLOADED";break;default:b="ERROR::CONNECTION"}this._getAnchor("errors").innerHTML=getLang(b);a.delay?503==a.code?this._getAnchor("countdown").style.display=
"block":this._getAnchor("retry").style.display="block":this._getAnchor("accept").style.display="block";gui.frm_main&&gui.frm_main.title&&(this.__titleID=gui.frm_main.title._add(getLang("ERROR::CONNECTION_ERROR"),5))}else this._main.style.display="none",this.__dimmer.style.display="none","undefined"!=typeof this.__interval&&window.clearInterval(this.__interval),this.__count=0};
_me._refresh=function(){0<this.__count?(this.btn_re._text(getLang("FORM_BUTTONS::RETRY")+" ("+this.__count+")"),this._getAnchor("countdown").innerHTML=getLang("ERROR::COUNTDOWN",[this.__count--])):this.btn_re._onclick()};_me.__destructor=function(){"undefined"!=typeof this.__interval&&window.clearInterval(this.__interval);this.__dimmer&&this.__dimmer.parentNode.removeChild(this.__dimmer)};
